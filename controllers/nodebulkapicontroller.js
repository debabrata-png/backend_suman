const jwt=require('jsonwebtoken');
const multer=require('multer');
const readXlsxFile = require("read-excel-file/node");
const Book=require('./../Models/book');
const Patents=require('./../Models/patents');
const Projects=require('./../Models/projects');
const Seminar=require('./../Models/seminar');
const Pub = require('./../Models/publications');


const Bos=require('./../Models/bos');
const Cbcs=require('./../Models/cbcs');
const Syllabus=require('./../Models/syllabusrev');
const Empb=require('./../Models/employability');
const Expl = require('./../Models/explearning');
const Admission=require('./../Models/admission');
const Reservecat=require('./../Models/reservecat');
const Tdata=require('./../Models/teacherdata');
const Passexam=require('./../Models/passexam');
const Taward = require('./../Models/teacheraward');
const Result=require('./../Models/result');
const Examauto=require('./../Models/examautomation');
const Mentees=require('./../Models/mentees');
const Instawards=require('./../Models/extawards');
const Extact = require('./../Models/extact');
const Collab=require('./../Models/collab');
const Mou=require('./../Models/mou');
const Econtent=require('./../Models/econtent');
const Seedm=require('./../Models/seedm');
const Tfellow = require('./../Models/teacherfellow');
const Rfellow=require('./../Models/researchfellow');
const Ict=require('./../Models/ict');
const Expd=require('./../Models/expenditure');
const Lib=require('./../Models/library');
const Scholarship = require('./../Models/studschsp');
const Skilldev=require('./../Models/skilldev');
const Careercounsel=require('./../Models/careercounsel');
//const Placement=require('./../Models/placement');
const Hedu=require('./../Models/higheredu');
const Hexam = require('./../Models/higherexam');
const Alumni=require('./../Models/alumnicon');
const Awards=require('./../Models/awards');
const Egovern=require('./../Models/egovern');
const Tfs=require('./../Models/teacherfs');
const Funds = require('./../Models/funds');
const Quality = require('./../Models/quality');

const Expproj = require('./../Models/explearnproj');
const Fieldproj = require('./../Models/fieldproj');
const Teacherguide = require('./../Models/teacherguide');
const Sportsact = require('./../Models/sportsact');
const Egov = require('./../Models/egov');
const Fdp = require('./../Models/fdp');
const Qualityinit = require('./../Models/qualityinit');
const Event = require('./../Models/event');
const Mouact = require('./../Models/mouact');

const Phdguide = require('./../Models/phdguide');
const Kpi=require('./../Models/kpi');

const Depprograms=require('./../Models/depprograms');
const Curstructure=require('./../Models/curstructure');

const Leavebalance=require('./../Models/leavebalance');
const nacademic=require('./../Models/nacademic');
const nworkbook=require('./../Models/nworkbook');
const nenrollment=require('./../Models/nenrollment');
const ncourseplan=require('./../Models/ncourseplan');
const ninter=require('./../Models/ninter');
const nclinicskills=require('./../Models/nclinicskills');
const nhlearner=require('./../Models/nhlearner');
const notherstud=require('./../Models/notherstud');
const nreval=require('./../Models/nreval');
const nfacilities=require('./../Models/nfacilities');
const ndepfunding=require('./../Models/ndepfunding');
const nprogcourse=require('./../Models/nprogcourse');
const nnvacstud=require('./../Models/nnvacstud');
const nnursinginter=require('./../Models/nnursinginter');
const nnexp=require('./../Models/nnexp');
const nnexam=require('./../Models/nnexam');
const nnratio=require('./../Models/nnratio');
const nnmentor=require('./../Models/nnmentor');

const necourse=require('./../Models/necourse');
const nnextension=require('./../Models/nnextension');
const nncollab=require('./../Models/nncollab');
const nnmou=require('./../Models/nnmou');
const nnpatients=require('./../Models/nnpatients');
const nnexposure=require('./../Models/nnexposure');

const nclient=require('./../Models/nclient');
const nmilestone=require('./../Models/nmilestone');
const ninvoice=require('./../Models/ninvoice');
const ngstgain=require('./../Models/ngstgain');
const nvendor=require('./../Models/nvendor');
const nvworkorder=require('./../Models/nvworkorder');
const nvinvoice=require('./../Models/nvinvoice');
const ntrialbalance=require('./../Models/ntrialbalance');

const nbudget=require('./../Models/nbudget');
const nledger=require('./../Models/nledger');
const naccounts=require('./../Models/naccounts');

const nseedmoney=require('./../Models/nseedmoney');
const nbudgetreq=require('./../Models/nbudgetreq');
const noodreq=require('./../Models/noodreq');
const neventreq=require('./../Models/neventreq');
const nassistantreq=require('./../Models/nassistantreq');
const nhousingreq=require('./../Models/nhousingreq');
const ntravelsupport=require('./../Models/ntravelsupport');

const ncompanies=require('./../Models/ncompanies');
const njobs=require('./../Models/njobs');
const njobstudents=require('./../Models/njobstudents');
const nhighereducation=require('./../Models/nhighereducation');

const noffcampus=require('./../Models/noffcampus');
const njobsapply=require('./../Models/njobsapply');
const nhigheredurep=require('./../Models/nhigheredurep');
const noffawards=require('./../Models/noffawards');
const noffscholarship=require('./../Models/noffscholarship');
const noffextension=require('./../Models/noffextension');
const noffcourses=require('./../Models/noffcourses');

const ncommittees=require('./../Models/ncommittees');
const ncommembers=require('./../Models/ncommembers');
const ncomminutes=require('./../Models/ncomminutes');
const ncomtasks=require('./../Models/ncomtasks');


const workload=require('./../Models/workload');
const lessonplan=require('./../Models/lessonplan');

const Class=require('./../Models/class');
const coursefiles=require('./../Models/coursefiles');

const co=require('./../Models/co');
const lannouncement=require('./../Models/lannouncement');
const lsyllabus=require('./../Models/lsyllabus');
const lcalendar=require('./../Models/lcalendar');

const user=require('./../Models/user');

const currenyear=require('./../Models/currenyear');

const studparents=require('./../Models/studparents');

const projectledger=require('./../Models/projectledger');
const projectcentral=require('./../Models/projectcentral');
const maintenance=require('./../Models/maintenance');
const otherincome=require('./../Models/otherincome');

const naccountheads=require('./../Models/naccountheads');
const ntransactions=require('./../Models/ntransactions');
const ntledger=require('./../Models/ntledger');


const nnursing812=require('./../Models/nnursing812');
const nnursing814=require('./../Models/nnursing814');
const nnursing815=require('./../Models/nnursing815');
const nnursing818=require('./../Models/nnursing818');
const nnursing424=require('./../Models/nnursing424');
const ncompetitive=require('./../Models/ncompetitive');
const nnursing515=require('./../Models/nnursing515');


const ndepmeetings=require('./../Models/ndepmeetings');
const nmeetingtasks=require('./../Models/nmeetingtasks');


const ndepmeetingsall=require('./../Models/ndepmeetingsall');
const nmeetingtasksall=require('./../Models/nmeetingtasksall');

const nallcourses=require('./../Models/nallcourses');

const verifystatus=require('./../Models/verifystatus');
const nissuesall=require('./../Models/nissuesall');
const ntickets=require('./../Models/ntickets');

const admission=require('./../Models/admission');
const passexam=require('./../Models/passexam');
const nbaug33result=require('./../Models/nbaug33result');
//const placement=require('./../Models/placement');
const writerdb=require('./../Models/writerdb');

const higheredu=require('./../Models/higheredu');
const higherexam=require('./../Models/higherexam');

const reservecat=require('./../Models/reservecat');
const phdfac=require('./../Models/phdfac');

const teacherdata=require('./../Models/teacherdata');
const result=require('./../Models/result');
const phdface=require('./../Models/phdface');

const nmetricissues=require('./../Models/nmetricissues');

const empexpenses=require('./../Models/empexpenses');
const eventexpenses=require('./../Models/eventexpenses');

const mentees=require('./../Models/mentees');

const alumnicon=require('./../Models/alumnicon');
const event=require('./../Models/event');

const teacherfs=require('./../Models/teacherfs');

const labsafety=require('./../Models/labsafety');
const labequipments=require('./../Models/labequipments');
const programbudget=require('./../Models/programbudget');
const internet=require('./../Models/internet');
const emfaculty=require('./../Models/emfaculty');
const studentpubs=require('./../Models/studentpubs');
const deppublications=require('./../Models/deppublications');
const facyear=require('./../Models/facyear');
const studmaster=require('./../Models/studmaster');
const seedm=require('./../Models/seedm');
const placement=require('./../Models/placement');

const studmasternew=require('./../Models/studmasternew');
const startup=require('./../Models/startup');


const acadperf=require('./../Models/acadperf');

const payslips=require('./../Models/payslips');
const payslipdetails=require('./../Models/payslipdetails');

const opencourse=require('./../Models/opencourse');
const openmodules=require('./../Models/openmodules');

const rapplication=require('./../Models/rapplication');
const rtrust=require('./../Models/rtrust');

const rinstitute=require('./../Models/rinstitute');

const rnotherc=require('./../Models/rnotherc');
const rnclassroom=require('./../Models/rnclassroom');
const rnlabs=require('./../Models/rnlabs');
const rnlibrarian=require('./../Models/rnlibrarian');
const rnvehicle=require('./../Models/rnvehicle');
const rnadministrative=require('./../Models/rnadministrative');
const rnaffhospital=require('./../Models/rnaffhospital');
const rndocuments=require('./../Models/rndocuments');
const rnonteaching=require('./../Models/rnonteaching');

const rnphospitals=require('./../Models/rnphospitals');
const rnbuilding=require('./../Models/rnbuilding');


const nqualification=require('./../Models/nqualification');
const nexperience=require('./../Models/nexperience');
const nmytasks=require('./../Models/nmytasks');
const salarydetails=require('./../Models/salarydetails');
const empapprec=require('./../Models/empapprec');

const nlibusage=require('./../Models/nlibusage');

const explearning=require('./../Models/explearning');
const nufacultydata=require('./../Models/nufacultydata');
//const phdface=require('./../Models/phdface');
//const teacherdata=require('./../Models/teacherdata');
//const result=require('./../Models/result');
const nugrievance=require('./../Models/nugrievance');
const passpercent=require('./../Models/passpercent');
const teacherfellow=require('./../Models/teacherfellow');
const patents=require('./../Models/patents');
const consultancy=require('./../Models/consultancy');
const mou=require('./../Models/mou');
const nuefacilities=require('./../Models/nuefacilities');
const nustudcompratio=require('./../Models/nustudcompratio');

//const higherexam=require('./../Models/higherexam');
const awards=require('./../Models/awards');


const nluteacherdata=require('./../Models/nluteacherdata');
const nlufacilities=require('./../Models/nlufacilities');
const nlurecognitions=require('./../Models/nlurecognitions');
const nlubills=require('./../Models/nlubills');
const nluincentives=require('./../Models/nluincentives');
const nluphdtheisis=require('./../Models/nluphdtheisis');
const nlucitation=require('./../Models/nlucitation');
const nlulegaldatabases=require('./../Models/nlulegaldatabases');
const nlbar=require('./../Models/nlbar');

const ainst=require('./../Models/ainst');

const pauidetailsa=require('./../Models/pauidetailsa');
const pauidetailsb=require('./../Models/pauidetailsb');
const pauidetailsc=require('./../Models/pauidetailsc');
const pautrust=require('./../Models/pautrust');
const pauprincipala=require('./../Models/pauprincipala');
const pauprincipalb=require('./../Models/pauprincipalb');
const paugovcouncila=require('./../Models/paugovcouncila');
const paugovcouncilb=require('./../Models/paugovcouncilb');
const pauboarda=require('./../Models/pauboarda');
const pauboardb=require('./../Models/pauboardb');
const pauragcomt=require('./../Models/pauragcomt');
const pauragsquad=require('./../Models/pauragsquad');
const pauwelfarecomt=require('./../Models/pauwelfarecomt');
const pauredressal=require('./../Models/pauredressal');
const paubankacnts=require('./../Models/paubankacnts');
const paudeposit=require('./../Models/paudeposit');
const pauendowment=require('./../Models/pauendowment');
const paulanddetailsa=require('./../Models/paulanddetailsa');
const paulanddetailsb=require('./../Models/paulanddetailsb');
const paucourse=require('./../Models/paucourse');
const paucrsedetails=require('./../Models/paucrsedetails');
const pauaddcrse=require('./../Models/pauaddcrse');
const paustuddetails=require('./../Models/paustuddetails');
const paufaculty=require('./../Models/paufaculty');
const paufdetailsa=require('./../Models/paufdetailsa');
const paufdetailsb=require('./../Models/paufdetailsb');
const paufeduqualif=require('./../Models/paufeduqualif');
const paufaddqualif=require('./../Models/paufaddqualif');
const paufacdexp=require('./../Models/paufacdexp');
const paufindexp=require('./../Models/paufindexp');
const paufcoeexp=require('./../Models/paufcoeexp');
const pauconfacshe=require('./../Models/pauconfacshe');
const pauconfaccourse=require('./../Models/pauconfaccourse');
const pauconfacmemtech=require('./../Models/pauconfacmemtech');
const paunontstaff=require('./../Models/paunontstaff');
const pauspacereq=require('./../Models/pauspacereq');
const pauequip=require('./../Models/pauequip');
const pauequiplist=require('./../Models/pauequiplist');
const pauccomfarea=require('./../Models/pauccomfarea');
const pautermlanwan=require('./../Models/pautermlanwan');
const paunoofterm=require('./../Models/paunoofterm');
const paunooftermlan=require('./../Models/paunooftermlan');
const paunoofprinters=require('./../Models/paunoofprinters');
const pausoftware=require('./../Models/pausoftware');
const paunetwork=require('./../Models/paunetwork');
const paulibarea=require('./../Models/paulibarea');
const paulibbooks=require('./../Models/paulibbooks');
const paulibjournal=require('./../Models/paulibjournal');
const pauavailclroom=require('./../Models/pauavailclroom');
const pausumofclroom=require('./../Models/pausumofclroom');
const paunoofdrawhall=require('./../Models/paunoofdrawhall');
const pauadminarea=require('./../Models/pauadminarea');
const pauamen=require('./../Models/pauamen');
const paubhostel=require('./../Models/paubhostel');
const paughostel=require('./../Models/paughostel');
const pauotherbuildarea=require('./../Models/pauotherbuildarea');
const pauphyedu=require('./../Models/pauphyedu');
const pautpc=require('./../Models/pautpc');
const paufacilityavail=require('./../Models/paufacilityavail');
const paualumni=require('./../Models/paualumni');
//const pautpc=require('./../Models/pautpc');
const pauhealth=require('./../Models/pauhealth');
const pauothamen=require('./../Models/pauothamen');
const pauregrec=require('./../Models/pauregrec');
const paucertificates=require('./../Models/paucertificates');
const pauprocfeea=require('./../Models/pauprocfeea');
const pauprocfeeb=require('./../Models/pauprocfeeb');
const pauprocfeec=require('./../Models/pauprocfeec');
const pauprcplendrsmnt=require('./../Models/pauprcplendrsmnt');
const paumngdeclaration=require('./../Models/paumngdeclaration');


const pnirf=require('./../Models/pnirf');
const padmnew=require('./../Models/padmnew');
const pnbanew=require('./../Models/pnbanew');
const paunfcoeexp=require('./../Models/paunfcoeexp');
const paunprincipala=require('./../Models/paunprincipala');
const paunfeduqualif=require('./../Models/paunfeduqualif');
const paunhealth=require('./../Models/paunhealth');
const paunnoofdrawhall=require('./../Models/paunnoofdrawhall');
const paunstuddetails=require('./../Models/paunstuddetails');

const paunnprincipal=require('./../Models/paunnprincipal');
const paungovcouncil=require('./../Models/paungovcouncil');
const paunboard=require('./../Models/paunboard');
const paunprocfee=require('./../Models/paunprocfee');
const pauntermlanwan=require('./../Models/pauntermlanwan');
const paunidetails=require('./../Models/paunidetails');
const paunfacultydetails=require('./../Models/paunfacultydetails');
const paunfaddqualif=require('./../Models/paunfaddqualif');
const paunfacdexp=require('./../Models/paunfacdexp');
const paunfindexp=require('./../Models/paunfindexp');
const paunnfeduqualif=require('./../Models/paunnfeduqualif');
const paunnfcoeexp=require('./../Models/paunnfcoeexp');
const paunadminarea=require('./../Models/paunadminarea');
const paunamen=require('./../Models/paunamen');
const paunotherbuildarea=require('./../Models/paunotherbuildarea');

const paunlibbooks=require('./../Models/paunlibbooks');
const paunewidetails=require('./../Models/paunewidetails');
const paunewprincipal=require('./../Models/paunewprincipal');
const pauclassblock=require('./../Models/pauclassblock');
const pauclassnew=require('./../Models/pauclassnew');
const paunlibjournal=require('./../Models/paunlibjournal');

const paunewfacultydetails=require('./../Models/paunewfacultydetails');
const paunewfaddqualif=require('./../Models/paunewfaddqualif');
const paunewfacdexp=require('./../Models/paunewfacdexp');
const paunewfindexp=require('./../Models/paunewfindexp');
const paunewfeduqualif=require('./../Models/paunewfeduqualif');
const paunewlanddetails=require('./../Models/paunewlanddetails');

const pauinstdetails=require('./../Models/pauinstdetails');
const pauinstcourse=require('./../Models/pauinstcourse');
const paunequip=require('./../Models/paunequip');
const paunewfcoeexp=require('./../Models/paunewfcoeexp');

const ainsmaster=require('./../Models/ainsmaster');

const nuexplearning=require('./../Models/nuexplearning');
const nucodeofethics=require('./../Models/nucodeofethics');
const nlufocus=require('./../Models/nlufocus');
const nluadmission=require('./../Models/nluadmission');
const nauscholarship=require('./../Models/nauscholarship');


const ppuclgdetails=require('./../Models/ppuclgdetails');
const ppuheaddetails=require('./../Models/ppuheaddetails');
const ppulegalrep=require('./../Models/ppulegalrep');
const pputrustdetails=require('./../Models/pputrustdetails');
const ppupermission=require('./../Models/ppupermission');
const ppumanagingbody=require('./../Models/ppumanagingbody');
const ppuwlfcomt=require('./../Models/ppuwlfcomt');
const pputrustfin=require('./../Models/pputrustfin');
const ppufdrdetails=require('./../Models/ppufdrdetails');
const ppuimmvprop=require('./../Models/ppuimmvprop');
const ppufinance=require('./../Models/ppufinance');
const ppuland=require('./../Models/ppuland');
const ppubuilding=require('./../Models/ppubuilding');
const ppuhostel=require('./../Models/ppuhostel');
const ppurooms=require('./../Models/ppurooms');
const ppuphyedu=require('./../Models/ppuphyedu');
const ppustaff=require('./../Models/ppustaff');
const ppucollege=require('./../Models/ppucollege');
const pputrust=require('./../Models/pputrust');
const ppuaddprog=require('./../Models/ppuaddprog');
const ppuvarintake=require('./../Models/ppuvarintake');
const ppuexistprog=require('./../Models/ppuexistprog');
const ppucourses=require('./../Models/ppucourses');
const ppucoursrep=require('./../Models/ppucoursrep');
const ppuprincipal=require('./../Models/ppuprincipal');
const ppufaculty=require('./../Models/ppufaculty');
const ppustafstudratio=require('./../Models/ppustafstudratio');
const ppulabequip=require('./../Models/ppulabequip');
const ppulabequipprocure=require('./../Models/ppulabequipprocure');
const ppulecturerooms=require('./../Models/ppulecturerooms');
const ppuavailclsroom=require('./../Models/ppuavailclsroom');
const ppunetwork=require('./../Models/ppunetwork');
const ppucompfaci=require('./../Models/ppucompfaci');
const ppucompsoftware=require('./../Models/ppucompsoftware');
const ppucompaddinfo=require('./../Models/ppucompaddinfo');
const ppucompaddsoft=require('./../Models/ppucompaddsoft');
const ppulibrary=require('./../Models/ppulibrary');
const ppulibstaff=require('./../Models/ppulibstaff');
const ppulibbooks=require('./../Models/ppulibbooks');
const ppulibindjrnl=require('./../Models/ppulibindjrnl');
const ppulibforgjrnl=require('./../Models/ppulibforgjrnl');
const ppulibautomation=require('./../Models/ppulibautomation');
const ppulibprocure=require('./../Models/ppulibprocure');
const ppulibexp=require('./../Models/ppulibexp');
const ppustudfaci=require('./../Models/ppustudfaci');
const ppuotherfaci=require('./../Models/ppuotherfaci');
const ppumedservice=require('./../Models/ppumedservice');
const ppuaudvidequip=require('./../Models/ppuaudvidequip');
const ppuclubs=require('./../Models/ppuclubs');
const pputechstaff=require('./../Models/pputechstaff');
const ppuminststaff=require('./../Models/ppuminststaff');
const ppuaddinfo=require('./../Models/ppuaddinfo');
const ppudeclaration=require('./../Models/ppudeclaration');
const ppucertificates=require('./../Models/ppucertificates');
const ppuaddinfoprog=require('./../Models/ppuaddinfoprog');
const ppuaddinfonoc=require('./../Models/ppuaddinfonoc');
const ppuaddinfopermission=require('./../Models/ppuaddinfopermission');
const ppuaddinfobos=require('./../Models/ppuaddinfobos');
const ppuaddinfosyllabi=require('./../Models/ppuaddinfosyllabi');
const ppuaddinfofac=require('./../Models/ppuaddinfofac');
const ppuaddinfostaffdetails=require('./../Models/ppuaddinfostaffdetails');
const ppuaddfacdetails=require('./../Models/ppuaddfacdetails');
const ppufacworkload=require('./../Models/ppufacworkload');


const hostel=require('./../Models/hostel');

const paunfacnew=require('./../Models/paunfacnew');
const pauprncplphd=require('./../Models/pauprncplphd');
const pauprncplpub=require('./../Models/pauprncplpub');


const awardsnew=require('./../Models/awardsnew');

const anlibjournals=require('./../Models/anlibjournals');

const vacstudents=require('./../Models/vacstudents');


const ninvoicen=require('./../Models/ninvoicen');

const ninvoicefinal=require('./../Models/ninvoicefinal');
const ninvoicefnew=require('./../Models/ninvoicefnew');
const norgdetails=require('./../Models/norgdetails');

const nstatus=require('./../Models/nstatus');
const nprojects=require('./../Models/nprojects');
const nprojectsnew=require('./../Models/nprojectsnew');

const innovationnew=require('./../Models/innovationnew');
const booknew=require('./../Models/booknew');
const expenditurenew=require('./../Models/expenditurenew');
const qualitynew=require('./../Models/qualitynew');
const lquality=require('./../Models/lquality');
const uquality=require('./../Models/uquality');
const studschspnew=require('./../Models/studschspnew');
const ustudschsp=require('./../Models/ustudschsp');

const studmasterall=require('./../Models/studmasterall');
const aequipments=require('./../Models/aequipments');
const afaccadre=require('./../Models/afaccadre');


const amprograms=require('./../Models/amprograms');
const amclassroom=require('./../Models/amclassroom');
const amequipments=require('./../Models/amequipments');
const amlibrary=require('./../Models/amlibrary');
const amlibdetails=require('./../Models/amlibdetails');
const amfaculties=require('./../Models/amfaculties');
const amadminstaff=require('./../Models/amadminstaff');
const aminfsuff=require('./../Models/aminfsuff');
const amimprovements=require('./../Models/amimprovements');
const amrecommendation=require('./../Models/amrecommendation');
const amchemicals=require('./../Models/amchemicals');
const amprogfaculties=require('./../Models/amprogfaculties');


const studmentor=require('./../Models/studmentor');
const lphdfac=require('./../Models/lphdfac');

const alumniusers=require('./../Models/alumniusers');
const alumniwork=require('./../Models/alumniwork');
const alumnihighered=require('./../Models/alumnihighered');
const alumnicontribute=require('./../Models/alumnicontribute');
const alumnijobs=require('./../Models/alumnijobs');
const alumnievents=require('./../Models/alumnievents');

const pfiles=require('./../Models/pfiles');
const pdeliverables=require('./../Models/pdeliverables');
const sssstud=require('./../Models/sssstud');


const admusers=require('./../Models/admusers');
const admedu=require('./../Models/admedu');
const admwork=require('./../Models/admwork');
const admprograms=require('./../Models/admprograms');
const admintern=require('./../Models/admintern');
const admextra=require('./../Models/admextra');
const admlanguages=require('./../Models/admlanguages');
const admfacilities=require('./../Models/admfacilities');
const admmarks=require('./../Models/admmarks');


const assignment=require('./../Models/assignment');
//const coursefiles=require('./../Models/coursefiles');

const affassign=require('./../Models/affassign');


const amcpdetails3=require('./../Models/amcpdetails3');
const amcpobservations=require('./../Models/amcpobservations');
const ammember1=require('./../Models/ammember1');
const ammbr2comp=require('./../Models/ammbr2comp');
const ammbr2det=require('./../Models/ammbr2det');

const mkustud=require('./../Models/mkustud');
const mkumarks=require('./../Models/mkumarks');

const anmstudnew=require('./../Models/anmstudnew');
const amastudnew=require('./../Models/amastudnew');

const affcolprog=require('./../Models/affcolprog');
const affproglist=require('./../Models/affproglist');
const Institutions=require('./../Models/institutions');

const rmsucoldeta=require('./../Models/rmsucoldeta');
const rmsunirf=require('./../Models/rmsunirf');
const rsmuaddeta=require('./../Models/rsmuaddeta');
const rsmucoldetaex=require('./../Models/rsmucoldetaex');
const rsmuprincdeta=require('./../Models/rsmuprincdeta');
const rsmugovcouncil=require('./../Models/rsmugovcouncil');
const rsmuragcomt=require('./../Models/rsmuragcomt');
const rsmuragsquad=require('./../Models/rsmuragsquad');
const rsmubankacnts=require('./../Models/rsmubankacnts');
const rsmudeposit=require('./../Models/rsmudeposit');
const rsmuendowment=require('./../Models/rsmuendowment');
const rsmubuildeta=require('./../Models/rsmubuildeta');
const rsmufeduqualif=require('./../Models/rsmufeduqualif');
const rsmufacnew=require('./../Models/rsmufacnew');
const rsmuontstaff=require('./../Models/rsmuontstaff');
const rmsucourse=require('./../Models/rmsucourse');
const rsunontstaff=require('./../Models/rsunontstaff');

const rsmuaddetacng=require('./../Models/rsmuaddetacng');
const rmsutrustdatacng=require('./../Models/rmsutrustdatacng');
const rsmufacnewcng=require('./../Models/rsmufacnewcng');
const rsmuendowmentcng=require('./../Models/rsmuendowmentcng');
const rsmulanddetacng=require('./../Models/rsmulanddetacng');

//const user=require('./../Models/user');

const rsmuadmup=require('./../Models/rsmuadmup');
const rsmucoldetaup=require('./../Models/rsmucoldetaup');
const rsmutrustup=require('./../Models/rsmutrustup');
const rsmuprinup=require('./../Models/rsmuprinup');
const rsmuendowup=require('./../Models/rsmuendowup');
const rsmuadcourup=require('./../Models/rsmuadcourup');
const rsmufacnewup=require('./../Models/rsmufacnewup');
const rsmufacqualifup=require('./../Models/rsmufacqualifup');
const rsmunontechup=require('./../Models/rsmunontechup');

//const sssstud=require('./../Models/sssstud');

const nlibtable1=require('./../Models/nlibtable1');
const nlibtable2=require('./../Models/nlibtable2');
const nofficefacility=require('./../Models/nofficefacility');

const msusancseatn=require('./../Models/msusancseatn');

const msuallfacnew=require('./../Models/msuallfacnew');

const awsconfig=require('./../Models/awsconfig');

const book=require('./../Models/book');

const feedback=require('./../Models/feedback');

const cocal=require('./../Models/cocal');

const payimages=require('./../Models/payimages');
const alumnipay=require('./../Models/alumnipay');

const amfacalln=require('./../Models/amfacalln');

const evguests=require('./../Models/evguests');

const genderaudit=require('./../Models/genderaudit');

const salarypaid=require('./../Models/salarypaid');
const emptravel=require('./../Models/emptravel');


const aauc1=require('./../Models/aauc1');
const aauc2=require('./../Models/aauc2');
const aaucother=require('./../Models/aaucother');
const aaucfees=require('./../Models/aaucfees');







const multerStorage=multer.diskStorage ({
    destination: (req, file, cb) => {
        cb(null, 'public/img/users');
    },
    filename: function (req, file, cb) {
        const uniqueSuffix = Date.now() + '-' + Math.round(Math.random() * 1E9)
        cb(null, Date.now().toString() + '-' + file.originalname);
      }
});

// exports.upload = multer({
//   storage: multerStorage
// });

var upload = multer({
    storage: multerStorage
  }).single('upl');

  exports.uploadfacbooks = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= Book.create({
                        colid: colid,
                        user: row[7],
                        name: row[8],
                        booktitle: row[0],
                        papertitle: row[1],
                        proceeding: row[2],
                        yop: row[3],
                        issn: row[4],
                        publisher: row[5],
                        affiliated:row[6],
                        status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};





exports.uploadnacademic = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nacademic.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        week: row[0],
day: row[1],
activitydate: row[2],
morning: row[3],
afternoon: row[4],
department: row[5],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};

exports.uploadnworkbook = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nworkbook.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        subject: row[0],
classdetails: row[1],
noofstudents: row[2],
activitydate: row[3],
time: row[4],
roomno: row[5],
department: row[6],
dayofweek: row[7],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnenrollment = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nenrollment.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        item: row[0],
firstyear: row[1],
secondyear: row[2],
thirdyear: row[3],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadncourseplan = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ncourseplan.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        coursecode: row[0],
course: row[1],
unit: row[2],
co: row[3],
content: row[4],
contentdate: new Date(row[5]),
hours: row[6],
reviseddate: new Date(row[7]),
resources: row[8],
outcome: row[9],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadninter = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ninter.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
totalprograms: row[1],
totalcourses: row[2],
interdisciplinary: row[3],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnclinicskills = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nclinicskills.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        facility: row[0],
status: row[1],
factraining: row[2],
studtraining: row[3],
department: row[4],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnhlearner = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nhlearner.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        item: row[0],
status: row[1],
department: row[2],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnotherstud = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= notherstud.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
nonhomestudent: row[1],
foreignstudent: row[2],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnreval = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nreval.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
singlereval: row[1],
doubleretotal: row[2],
doublereval: row[3],
answerscript: row[4],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnfacilities = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nfacilities.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        facility: row[0],
year: row[1],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadndepfunding = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ndepfunding.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        department: row[0],
scheme: row[1],
agency: row[2],
year: row[3],
funds: row[4],
duration: row[5],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};



exports.uploadnprogcourse = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nprogcourse.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        department: row[0],
programcode: row[1],
programname: row[2],
coursecode: row[3],
course: row[4],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnnvacstud = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nnvacstud.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
studentname: row[1],
totalstudents: row[2],
department: row[3],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnnursinginter = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nnursinginter.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
programname: row[1],
totalcourses: row[2],
department: row[3],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnnexp = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nnexp.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
fieldvisit: row[1],
internship: row[2],
research: row[3],
industry: row[4],
posting: row[5],
total: row[6],
department: row[7],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnnratio = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nnratio.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        ugstudents: row[0],
pgstudents: row[1],
teachers: row[2],
ugratio: row[3],
pgratio: row[4],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnnmentor = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nnmentor.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        mentornumber: row[0],
totalstudents: row[1],
totalmentees: row[2],
ratio: row[3],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnnexam = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nnexam.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        item: row[0],
status: row[1],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};




// few 1

exports.uploadnecourse = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= necourse.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
noofteachers: row[1],
faculty: row[2],
courselink: row[3],
department: row[4],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnnextension = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nnextension.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
activity: row[1],
noofstudents: row[2],
noofteachers: row[3],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnncollab = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nncollab.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
title: row[1],
agency: row[2],
participants: row[3],
financesource: row[4],
duration: row[5],
activitynature: row[6],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnnmou = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nnmou.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
title: row[1],
agency: row[2],
duration: row[3],
activities: row[4],
noofparticipants: row[5],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnnpatients = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nnpatients.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
outpatientno: row[1],
outpatientratio: row[2],
inpatientno: row[3],
inpatientratio: row[4],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnnexposure = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nnexposure.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
resource: row[1],
ugstudentno: row[2],
pgstudentno: row[3],
department: row[4],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnclient = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nclient.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        name: row[0],
address: row[1],
state: row[2],
country: row[3],
gst: row[4],
pan: row[5],
type: row[6],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnmilestone = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nmilestone.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        client: row[0],
clientid: row[1],
milestone: row[2],
duedate: new Date(row[3]),
amount: row[4],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadninvoice = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ninvoice.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
client: row[1],
milestone: row[2],
amount: row[3],
gst: row[4],
total: row[5],
invoiceid: row[6],
duedate: new Date(row[7]),
actualdate: new Date(row[8]),
paidamount: row[9],
bank: row[10],
refno: row[11],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadngstgain = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ngstgain.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
client: row[1],
amount: row[2],
gst: row[3],
total: row[4],
paydate: new Date(row[5]),
bank: row[6],
refno: row[7],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnvendor = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nvendor.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        name: row[0],
address: row[1],
state: row[2],
country: row[3],
gst: row[4],
pan: row[5],
type: row[6],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnvworkorder = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nvworkorder.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        vendor: row[0],
workorder: row[1],
workorderid: row[2],
details: row[3],
duedate: new Date(row[4]),
amount: row[5],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnvinvoice = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nvinvoice.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
vendor: row[1],
workorder: row[2],
workorderid: row[3],
amount: row[4],
gst: row[5],
total: row[6],
invoiceid: row[7],
duedate: new Date(row[8]),
actualdate: new Date(row[9]),
paidamount: row[10],
bank: row[11],
refno: row[12],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadntrialbalance = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ntrialbalance.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
acccode: row[1],
account: row[2],
transaction: row[3],
category: row[4],
group: row[5],
debit: row[6],
credit: row[7],
transactiondate: new Date(row[8]),
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnbudget = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nbudget.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
acccode: row[1],
account: row[2],
transaction: row[3],
category: row[4],
group: row[5],
debit: row[6],
credit: row[7],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnledger = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nledger.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
acccode: row[1],
account: row[2],
transaction: row[3],
category: row[4],
group: row[5],
debit: row[6],
credit: row[7],
transactiondate: row[8],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnaccounts = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= naccounts.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        acccode: row[0],
account: row[1],
description: row[2],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnseedmoney = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nseedmoney.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
project: row[1],
description: row[2],
amount: row[3],
copi: row[4],
department: row[5],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnbudgetreq = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nbudgetreq.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
item: row[1],
description: row[2],
amount: row[3],
transactiondate: row[4],
department: row[5],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnoodreq = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= noodreq.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
task: row[1],
description: row[2],
amount: row[3],
transactiondate: row[4],
department: row[5],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadneventreq = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= neventreq.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
event: row[1],
description: row[2],
amount: row[3],
transactiondate: row[4],
department: row[5],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnassistantreq = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nassistantreq.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
item: row[1],
description: row[2],
noofpeople: row[3],
amount: row[4],
startdate: row[5],
enddate: row[6],
department: row[7],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnhousingreq = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nhousingreq.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
item: row[1],
description: row[2],
noofpeople: row[3],
amount: row[4],
startdate: row[5],
enddate: row[6],
department: row[7],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadntravelsupport = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ntravelsupport.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
item: row[1],
description: row[2],
seminar: row[3],
role: row[4],
type: row[5],
amount: row[6],
startdate: row[7],
enddate: row[8],
department: row[9],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};



exports.uploadncompanies = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ncompanies.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        name: row[0],
address: row[1],
country: row[2],
hrname: row[3],
hremail: row[4],
hrphone: row[5],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnjobs = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= njobs.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
company: row[1],
jobtitle: row[2],
jobdescription: row[3],
lastapplydate: row[4],
eligibility: row[5],
salary: row[6],
domain: row[7],
type: row[8],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnjobstudents = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= njobstudents.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
company: row[1],
jobid: row[2],
salary: row[3],
program: row[4],
student: row[5],
department: row[6],
regno: row[7],
studentcontact: row[8],
selectiondate: row[9],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnhighereducation = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nhighereducation.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
institute: row[1],
targetprogram: row[2],
program: row[3],
student: row[4],
department: row[5],
regno: row[6],
studentcontact: row[7],
selectiondate: row[8],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};



exports.uploadnoffcampus = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= noffcampus.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
company: row[1],
job: row[2],
salary: row[3],
currentprogram: row[4],
student: row[5],
department: row[6],
studentregno: row[7],
studentcontact: row[8],
selectiondate: row[9],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnjobsapply = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= njobsapply.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
company: row[1],
jobid: row[2],
job: row[3],
salary: row[4],
currentprogram: row[5],
student: row[6],
department: row[7],
studentregno: row[8],
studentcontact: row[9],
selectiondate: row[10],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnhigheredurep = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nhigheredurep.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
institute: row[1],
targetprogram: row[2],
currentprogram: row[3],
student: row[4],
department: row[5],
studentregno: row[6],
studentcontact: row[7],
selectiondate: row[8],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnoffawards = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= noffawards.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
institution: row[1],
event: row[2],
award: row[3],
currentprogram: row[4],
student: row[5],
department: row[6],
studentregno: row[7],
studentcontact: row[8],
selectiondate: row[9],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnoffscholarship = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= noffscholarship.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
agency: row[1],
scholarship: row[2],
amount: row[3],
type: row[4],
currentprogram: row[5],
student: row[6],
department: row[7],
studentregno: row[8],
studentcontact: row[9],
selectiondate: row[10],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnoffextension = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= noffextension.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
institution: row[1],
event: row[2],
currentprogram: row[3],
student: row[4],
department: row[5],
studentregno: row[6],
studentcontact: row[7],
eventdate: row[8],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnoffcourses = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= noffcourses.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
institution: row[1],
course: row[2],
hours: row[3],
currentprogram: row[4],
student: row[5],
department: row[6],
studentregno: row[7],
studentcontact: row[8],
selectiondate: row[9],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


// committees


exports.uploadncommittees = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ncommittees.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        fromyear: row[0],
committee: row[1],
description: row[2],
members: row[3],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadncommembers = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ncommembers.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        committee: row[0],
committeeid: row[1],
member: row[2],
username: row[3],
memberfrom: new Date(row[4]),
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadncomminutes = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ncomminutes.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
committee: row[1],
committeeid: row[2],
agenda: row[3],
meetingdate: new Date(row[4]),
type: row[5],
discussion: row[6],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadncomtasks = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ncomtasks.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
task: row[1],
description: row[2],
startdate: new Date(row[3]),
targetdate: new Date(row[4]),
enddate: new Date(row[5]),
status: row[6],
owner: row[7],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadworkload = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= workload.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        coursecode: row[0],
semester: row[1],
section: row[2],
course: row[3],
program: row[4],
type: row[5],
module: row[6],
hours: row[7],
status: row[8],
year: row[9],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadworkloadbulk = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= workload.create({
                        colid: colid,
                        user: row[11],
                        name: row[12],
                        coursecode: row[0],
semester: row[1],
section: row[2],
course: row[3],
program: row[4],
type: row[5],
module: row[6],
hours: row[7],
status: row[8],
year: row[9],
programcode: row[10],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadlessonplan = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= lessonplan.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        department: row[0],
coursecode: row[1],
link: row[2],
semester: row[3],
section: row[4],
classdate: row[5],
actualdate: row[6],
course: row[7],
program: row[8],
programcode: row[9],
academicyear: row[10],
topic: row[11],
module: row[12],
objective: row[13],
pedagogy: row[14],
type: row[15],
unit: row[16],
content: row[17],
outcome: row[18],
noofhours: row[19],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};

exports.uploadlessonplannew = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        const program=req.body.program;
        const programcode=req.body.programcode;
        const course=req.body.course;
        const coursecode=req.body.coursecode;
        const semester=req.body.semester;
        const section=req.body.section;
        const department=req.body.department;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= lessonplan.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        department: department,
coursecode: coursecode,
link: 'NA',
semester: semester,
section: section,
classdate: new Date(row[0]),
course: course,
program: program,
programcode: programcode,
academicyear: row[1],
topic: row[2],
module: 'NA',
objective: row[3],
pedagogy: row[4],
type: row[5],
unit: row[6],
noofhours: row[7],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};



exports.uploadClass = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= Class.create({
                        colid: colid,
                        user: row[14],
                        name: row[15],
                        year: row[0],
program: row[1],
programcode: row[2],
course: row[3],
coursecode: row[4],
semester: row[5],
section: row[6],
classdate: new Date(row[7] + ' ' + row[8]),
classtime: row[8],
link: row[9],
topic: row[10],
module: row[11],
enrollreq: row[12],
status: 1,
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadcoursefiles = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= coursefiles.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        coursecode: row[0],
filename: row[1],
link: row[2],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadco = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= co.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        coursecode: row[0],
coursename: row[1],
co: row[2],
cocode: row[3],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadlannouncement = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= lannouncement.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
coursecode: row[1],
coursename: row[2],
announcement: row[3],
dateposted: new Date(row[4]),
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadlsyllabus = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= lsyllabus.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        department: row[0],
year: row[1],
coursename: row[2],
coursecode: row[3],
module: row[4],
description: row[5],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadlcalendar = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= lcalendar.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        department: row[0],
coursecode: row[1],
course: row[2],
year: row[3],
activity: row[4],
description: row[5],
planneddate: new Date(row[6]),
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadstudents = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const addedby=req.body.addedby;
        //const role=req.body.role;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= user.create({
                        colid: colid,
                        user: user1,
                        addedby: addedby,
                        name: row[0],
email: row[1],
phone: row[2],
password: row[3],
role: 'Student',
programcode: row[4],
regno: row[5],
admissionyear: row[6],
gender: row[7],
semester: row[8],
section: row[9],
department: row[10],
category: row[11],
address: row[12],
quota: row[13],
status: 1,
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};

exports.uploadothers = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const addedby=req.body.addedby;
        const role=req.body.role;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= user.create({
                        colid: colid,
                        user: user1,
                        addedby: addedby,
                        name: row[0],
email: row[1],
phone: row[2],
password: row[3],
role: role,
programcode: row[4],
regno: row[5],
admissionyear: row[6],
gender: row[7],
semester: 'NA',
section: 'NA',
department: row[8],
category: row[9],
address: row[10],
quota: row[11],
status: 1,
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadcurrenyear = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= currenyear.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        program: row[0],
programcode: row[1],
semester: row[2],
section: row[3],
year: row[4],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadstudparents = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= studparents.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        student: row[0],
regno: row[1],
parent: row[2],
email: row[3],
phone: row[4],
username: row[5],
password: row[6],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};



exports.uploadprojectledger = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= projectledger.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
department: row[1],
project: row[2],
faculty: row[3],
fundingagency: row[4],
transaction: row[5],
account: row[6],
amountreceived: row[7],
amountspent: row[8],
transactiondate: row[9],
category: row[10],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadprojectcentral = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= projectcentral.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
department: row[1],
project: row[2],
faculty: row[3],
fundingagency: row[4],
transaction: row[5],
account: row[6],
amountreceived: row[7],
amountspent: row[8],
transactiondate: row[9],
category: row[10],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadmaintenance = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= maintenance.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
account: row[1],
transaction: row[2],
amount: row[3],
transactiondate: row[4],
type: row[5],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadotherincome = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= otherincome.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
account: row[1],
agency: row[2],
transaction: row[3],
amount: row[4],
transactiondate: row[5],
type: row[6],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnaccountheads = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= naccountheads.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        account: row[0],
acccode: row[1],
description: row[2],
region: row[3],
type: row[4],
category: row[5],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadntransactions = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ntransactions.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
transaction: row[1],
description: row[2],
amount: row[3],
transactiondate: row[4],
bank: row[5],
party: row[6],
type: row[7],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadntledger = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ntledger.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
account: row[1],
transaction: row[2],
amount: row[3],
type: row[4],
transactiondate: row[5],
transactionid: row[6],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};





exports.uploadnnursing812 = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nnursing812.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        teacher: row[0],
degreeyear: row[1],
institution: row[2],
yearofjoining: row[3],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnnursing814 = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nnursing814.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
studentsadmitted: row[1],
immunizedno: row[2],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnnursing815 = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nnursing815.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        accreditation: row[0],
status: row[1],
year: row[2],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnnursing818 = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nnursing818.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
faculty: row[1],
committee: row[2],
tenure: row[3],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnnursing424 = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nnursing424.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        facility: row[0],
status: row[1],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadncompetitive = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ncompetitive.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
scheme: row[1],
studentsparticipated: row[2],
totalstudents: row[3],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnnursing515 = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nnursing515.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        type: row[0],
guidelines: row[1],
committee: row[2],
meetings: row[3],
actiontaken: row[4],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};



exports.uploadndepmeetings = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ndepmeetings.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        department: row[0],
year: row[1],
host: row[2],
hostemail: row[3],
hostphone: row[4],
meetingdate: row[5],
comments: row[6],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnmeetingtasks = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nmeetingtasks.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        department: row[0],
meetingid: row[1],
year: row[2],
host: row[3],
hostemail: row[4],
hostphone: row[5],
duedate: row[6],
task: row[7],
comments: row[8],
status: row[9],
issues: row[10],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};



exports.uploadndepmeetingsall = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ndepmeetingsall.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        department: row[0],
year: row[1],
host: row[2],
hostemail: row[3],
hostphone: row[4],
meetingdate: row[5],
details: row[6],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnmeetingtasksall = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nmeetingtasksall.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        department: row[0],
meetingid: row[1],
year: row[2],
host: row[3],
hostemail: row[4],
hostphone: row[5],
duedate: row[6],
task: row[7],
details: row[8],
status: row[9],
issues: row[10],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnallcourses = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nallcourses.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        department: row[0],
introductionyear: row[1],
discontinueyear: row[2],
program: row[3],
programcode: row[4],
course: row[5],
coursecode: row[6],
coursetype: row[7],
lecture: row[8],
theory: row[9],
practical: row[10],
total: row[11],
credits: row[12],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};



exports.uploadverifystatus = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= verifystatus.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        criteria: row[0],
metric: row[1],
department: row[2],
category: row[3],
docid: row[4],
comments: row[5],
status: row[6],
datechecked: row[7],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnissuesall = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nissuesall.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        issue: row[0],
owner: row[1],
owneremail: row[2],
department: row[3],
description: row[4],
comments: row[5],
createddate: row[6],
duedate: row[7],
status: row[8],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadntickets = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ntickets.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        issue: row[0],
description: row[1],
datecreated: row[2],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};



exports.uploadadmission = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= admission.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
programname: row[1],
programcode: row[2],
sancseat: row[3],
studapply: row[4],
studadmt: row[5],
lateral: row[6],
sepdevision: row[7],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpassexam = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= passexam.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
studyyear: row[1],
programcode: row[2],
programname: row[3],
studappear: row[4],
studpass: row[5],
backlog: row[6],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnbaug33result = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nbaug33result.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
studname: row[1],
regno: row[2],
programname: row[3],
programcode: row[4],
score: row[5],
result: row[6],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadplacement = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= placement.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
programname: row[1],
programcode: row[2],
studentname: row[3],
studcontactdetails: row[4],
regno: row[5],
sector: row[6],
designation: row[7],
employerid: row[8],
jobid: row[9],
employername: row[10],
empcontactdetails: row[11],
salary: row[12],
empaddress: row[13],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadwriterdb = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= writerdb.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        type: row[0],
category: row[1],
description: row[2],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadhigheredu = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= higheredu.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
studentname: row[1],
programgrad: row[2],
programcode: row[3],
institution: row[4],
programadm: row[5],
studadmt: row[6],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadhigherexam = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= higherexam.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
regno: row[1],
studentname: row[2],
programname: row[3],
programcode: row[4],
examname: row[5],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadreservecat = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= reservecat.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
programname: row[1],
programcode: row[2],
category: row[3],
sancseat: row[4],
studadmt: row[5],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};

//phdfac

exports.uploadphdfac = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= phdfac.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        faculty: row[0],
phdyear: row[1],
pgyear: row[2],
qualification: row[3],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


// end phdfac

// teacherdata phdface examdays


// exports.uploadteacherdata = function(req, res) {
//     //console.log('processing file upload');
    
//     upload(req,res,function(err) {
//         if(err) {
//             //console.log("Error uploading file." + err.toString());
//             return res.end("Error uploading file." + err.toString());
//         }
//         const name=req.body.name;
//         const colid=req.body.colid;
//         //console.log('files ' + req.files);
//         const user1=req.body.user;
//         const token=req.body.token;
//         //console.log('token ' + token);
//         let jwtuser='';
//         let jwtcolid='';
//         try {
//             const verified = jwt.verify(
//                 token,
//                 process.env.JWT_SECRET,
//                 (err123, verified) => {
//                   if (err123) {
//                     return res.status(401).json({
//                         status: 'Unauthorized',
//                         error: err123
//                     });
//                   }
//                   jwtuser=verified.user;
//                   jwtcolid=verified.colid;
//                   return verified;
//                 }
//               );
//               //console.log(verified);
    
//         } catch(err1234) {
//             //console.log(err1234);
//         }
//         //console.log('token verified ' + jwtuser + '-' + jwtcolid);

//         try {
//             let path1="public/img/users/" + req.file.filename;
//             //console.log(path1);
//             readXlsxFile(path1).then((rows) => {
//                 // skip header
//                 rows.shift();
      
//                 let tutorials = [];
      
//                 rows.forEach((row) => {
//                     const pat1= teacherdata.create({
//                         colid: colid,
//                         user: user1,
//                         name: name,
//                         year: row[0],
// fname: row[1],
// department: row[2],
// pan: row[3],
// designation: row[4],
// yoa: row[5],
// type: row[6],
// yoe: row[7],
// status: row[8],
// lastyear: row[9],
// status1: 'Submitted',
//                         comments: 'NA'
                    
//                     });

                    
      
//               //tutorials.push(tutorial);
//                 });
//             });
//             //console.log('uploaded');
//             res.status(401).json({
//                 status: 'Success'
//             });
//         } catch(err1) {
//             res.status(401).json({
//                 status: 'Error',
//                 error: err1
//             });

//         }

//     });
// };


// exports.uploadresult = function(req, res) {
//     //console.log('processing file upload');
    
//     upload(req,res,function(err) {
//         if(err) {
//             //console.log("Error uploading file." + err.toString());
//             return res.end("Error uploading file." + err.toString());
//         }
//         const name=req.body.name;
//         const colid=req.body.colid;
//         //console.log('files ' + req.files);
//         const user1=req.body.user;
//         const token=req.body.token;
//         //console.log('token ' + token);
//         let jwtuser='';
//         let jwtcolid='';
//         try {
//             const verified = jwt.verify(
//                 token,
//                 process.env.JWT_SECRET,
//                 (err123, verified) => {
//                   if (err123) {
//                     return res.status(401).json({
//                         status: 'Unauthorized',
//                         error: err123
//                     });
//                   }
//                   jwtuser=verified.user;
//                   jwtcolid=verified.colid;
//                   return verified;
//                 }
//               );
//               //console.log(verified);
    
//         } catch(err1234) {
//             //console.log(err1234);
//         }
//         //console.log('token verified ' + jwtuser + '-' + jwtcolid);

//         try {
//             let path1="public/img/users/" + req.file.filename;
//             //console.log(path1);
//             readXlsxFile(path1).then((rows) => {
//                 // skip header
//                 rows.shift();
      
//                 let tutorials = [];
      
//                 rows.forEach((row) => {
//                     const pat1= result.create({
//                         colid: colid,
//                         user: user1,
//                         name: name,
//                         year: row[0],
// programcode: row[1],
// programname: row[2],
// semester: row[3],
// lastdate: row[4],
// resultdate: row[5],
// status1: 'Submitted',
//                         comments: 'NA'
                    
//                     });

                    
      
//               //tutorials.push(tutorial);
//                 });
//             });
//             //console.log('uploaded');
//             res.status(401).json({
//                 status: 'Success'
//             });
//         } catch(err1) {
//             res.status(401).json({
//                 status: 'Error',
//                 error: err1
//             });

//         }

//     });
// };


// exports.uploadphdface = function(req, res) {
//     //console.log('processing file upload');
    
//     upload(req,res,function(err) {
//         if(err) {
//             //console.log("Error uploading file." + err.toString());
//             return res.end("Error uploading file." + err.toString());
//         }
//         const name=req.body.name;
//         const colid=req.body.colid;
//         //console.log('files ' + req.files);
//         const user1=req.body.user;
//         const token=req.body.token;
//         //console.log('token ' + token);
//         let jwtuser='';
//         let jwtcolid='';
//         try {
//             const verified = jwt.verify(
//                 token,
//                 process.env.JWT_SECRET,
//                 (err123, verified) => {
//                   if (err123) {
//                     return res.status(401).json({
//                         status: 'Unauthorized',
//                         error: err123
//                     });
//                   }
//                   jwtuser=verified.user;
//                   jwtcolid=verified.colid;
//                   return verified;
//                 }
//               );
//               //console.log(verified);
    
//         } catch(err1234) {
//             //console.log(err1234);
//         }
//         //console.log('token verified ' + jwtuser + '-' + jwtcolid);

//         try {
//             let path1="public/img/users/" + req.file.filename;
//             //console.log(path1);
//             readXlsxFile(path1).then((rows) => {
//                 // skip header
//                 rows.shift();
      
//                 let tutorials = [];
      
//                 rows.forEach((row) => {
//                     const pat1= phdface.create({
//                         colid: colid,
//                         user: user1,
//                         name: name,
//                         faculty: row[0],
// phdyear: row[1],
// pgyear: row[2],
// qualification: row[3],
// department: row[4],
// email: row[5],
// empid: row[6],
// gender: row[7],
// joinyear: row[8],
// leftyear: row[9],
// designation: row[10],
// joiningdate: row[11],
// leavingdate: row[12],
// pan: row[13],
// status1: 'Submitted',
//                         comments: 'NA'
                    
//                     });

                    
      
//               //tutorials.push(tutorial);
//                 });
//             });
//             //console.log('uploaded');
//             res.status(401).json({
//                 status: 'Success'
//             });
//         } catch(err1) {
//             res.status(401).json({
//                 status: 'Error',
//                 error: err1
//             });

//         }

//     });
// };






// end teacherdata phdface examdays

exports.uploadnmetricissues = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nmetricissues.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        criteria: row[0],
metric: row[1],
category: row[2],
department: row[3],
issues: row[4],
datechecked: row[5],
status: row[6],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadempexpenses = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= empexpenses.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        type: row[0],
year: row[1],
expcode: row[2],
from: row[3],
to: row[4],
expdate: row[5],
clientcode: row[6],
purpose: row[7],
amount: row[8],
approved: row[9],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadeventexpenses = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= eventexpenses.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        type: row[0],
year: row[1],
expcode: row[2],
from: row[3],
to: row[4],
expdate: row[5],
eventcode: row[6],
purpose: row[7],
amount: row[8],
approved: row[9],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};



exports.uploadmentees = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);
  
        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= mentees.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        department: row[0],
  year: row[1],
  mentor: row[2],
  noofmentee: row[3],
  status1: 'Submitted',
                        comments: 'NA'
                    
                    });
  
                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });
  
        }
  
    });
  };
  
  
  exports.uploadalumnicon = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= alumnicon.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        department: row[0],
year: row[1],
amount: row[2],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadevent = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= event.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        eventname: row[0],
description: row[1],
department: row[2],
brochurelink: row[3],
date: row[4],
time: row[5],
coordinator: row[6],
type: row[7],
academicyear: row[8],
noofparticipants: row[9],
noofteachers: row[10],
eventlink: row[11],
fromto: row[12],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadteacherfs = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= teacherfs.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
tname: row[1],
workshop: row[2],
profbody: row[3],
amount: row[4],
source: row[5],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadlabsafety = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= labsafety.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        labname: row[0],
safety: row[1],
programname: row[2],
programcode: row[3],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadlabequipments = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= labequipments.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        labname: row[0],
equipments: row[1],
programname: row[2],
programcode: row[3],
batchsize: row[4],
utilization: row[5],
staffname: row[6],
designation: row[7],
qualification: row[8],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadprogrambudget = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= programbudget.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
programname: row[1],
programcode: row[2],
type: row[3],
nonrecurringbudget: row[4],
recurringbudget: row[5],
nonrecurringexp: row[6],
recurringexp: row[7],
expperstudent: row[8],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadinternet = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= internet.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        provider: row[0],
programname: row[1],
programcode: row[2],
bandwidth: row[3],
wifi: row[4],
internetaccess: row[5],
cybersecurity: row[6],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploademfaculty = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= emfaculty.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        programname: row[0],
programcode: row[1],
faculty: row[2],
year: row[3],
noofhours: row[4],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadstudentpubs = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= studentpubs.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        academicyear: row[0],
programname: row[1],
programcode: row[2],
student: row[3],
regno: row[4],
publication: row[5],
award: row[6],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploaddeppublications = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= deppublications.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
programname: row[1],
programcode: row[2],
publication: row[3],
editor: row[4],
publisher: row[5],
type: row[6],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadfacyear = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= facyear.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
programname: row[1],
programcode: row[2],
faculty: row[3],
designation: row[4],
qualification: row[5],
pgyear: row[6],
phdyear: row[7],
yoa: row[8],
pan: row[9],
empid: row[10],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadstudmaster = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= studmaster.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
programname: row[1],
programcode: row[2],
name: row[3],
regno: row[4],
admissionyear: row[5],
semester: row[6],
isfinalyear: row[7],
repeat: row[8],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadseedm = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= seedm.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
programname: row[1],
programcode: row[2],
fname: row[3],
project: row[4],
duration: row[5],
amount: row[6],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadplacement = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= placement.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
programname: row[1],
programcode: row[2],
studentname: row[3],
studcontactdetails: row[4],
regno: row[5],
sector: row[6],
employername: row[7],
empaddress: row[8],
empcontactdetails: row[9],
salary: row[10],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};



exports.uploadstudmasternew = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= studmasternew.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
programname: row[1],
programcode: row[2],
name: row[3],
regno: row[4],
admissionyear: row[5],
semester: row[6],
isfinalyear: row[7],
repeat: row[8],
gender: row[9],
category1: row[10],
category2: row[11],
pwd: row[12],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadstartup = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= startup.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        yop: row[0],
programname: row[1],
programcode: row[2],
department: row[3],
startupname: row[4],
description: row[5],
startupdate: row[6],
student: row[7],
regno: row[8],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};




exports.uploadacadperf = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= acadperf.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
programname: row[1],
programcode: row[2],
student: row[3],
regno: row[4],
marks: row[5],
semester: row[6],
result: row[7],
repeat: row[8],
isfinal: row[9],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};



exports.uploadpayslips = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= payslips.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
month: row[1],
netpay: row[2],
grosspay: row[3],
paydate: row[4],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpayslipdetails = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= payslipdetails.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        payslipid: row[0],
year: row[1],
month: row[2],
item: row[3],
type: row[4],
amount: row[5],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};

exports.uploadopencourse = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= opencourse.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
coursecode: row[1],
coursename: row[2],
startdate: row[3],
price: row[4],
description: row[5],
skills: row[6],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadopenmodules = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= openmodules.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        coursecode: row[0],
module: row[1],
description: row[2],
link: row[3],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadrapplication = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= rapplication.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
faculty: row[1],
type: row[2],
course: row[3],
college: row[4],
society: row[5],
principal: row[6],
principalmob: row[7],
email: row[8],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadrtrust = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= rtrust.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
orgtype: row[1],
orgname: row[2],
president: row[3],
address: row[4],
city: row[5],
district: row[6],
state: row[7],
taluk: row[8],
pin: row[9],
std: row[10],
landline: row[11],
fax: row[12],
orgemail: row[13],
orgmobile: row[14],
orgregno: row[15],
orgregdate: row[16],
amedment: row[17],
othercollege: row[18],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};



exports.uploadrinstitute = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= rinstitute.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
orgname: row[1],
address: row[2],
city: row[3],
district: row[4],
state: row[5],
taluk: row[6],
pin: row[7],
std: row[8],
landline: row[9],
fax: row[10],
orgemail: row[11],
orgmobile: row[12],
website: row[13],
establishmentyear: row[14],
surveyno: row[15],
isrural: row[16],
isminority: row[17],
minoritytype: row[18],
coursename: row[19],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadrnotherc = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= rnotherc.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
program: row[1],
offerstatus: row[2],
notificationno: row[3],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadrnclassroom = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= rnclassroom.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
program: row[1],
classroomsize: row[2],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadrnlabs = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= rnlabs.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
labtype: row[1],
labsize: row[2],
simulatorno: row[3],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadrnlibrarian = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= rnlibrarian.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
librarianname: row[1],
qualification: row[2],
experience: row[3],
remarks: row[4],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadrnvehicle = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= rnvehicle.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
vehicleregno: row[1],
capacity: row[2],
rcbook: row[3],
insurance: row[4],
dl: row[5],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadrnadministrative = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= rnadministrative.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
facility: row[1],
availability: row[2],
sizeinsqft: row[3],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadrnaffhospital = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= rnaffhospital.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
hospital: row[1],
totalbeds: row[2],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadrndocuments = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= rndocuments.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
document: row[1],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadrnonteaching = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= rnonteaching.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
staffname: row[1],
department: row[2],
designation: row[3],
qualification: row[4],
totalexperience: row[5],
aadhar: row[6],
pan: row[7],
email: row[8],
phone: row[9],
remarks: row[10],
address: row[11],
city: row[12],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};

exports.uploadrnphospitals = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= rnphospitals.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
collegehospital: row[1],
parenthospital: row[2],
ownedby: row[3],
hospitalname: row[4],
location: row[5],
noofbeds: row[6],
opdperday: row[7],
ipdperday: row[8],
anyother: row[9],
distance: row[10],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadrnbuilding = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= rnbuilding.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
type: row[1],
owner: row[2],
courtcase: row[3],
allcourses: row[4],
noofrooms: row[5],
nooflabs: row[6],
safewater: row[7],
auditorium: row[8],
officefacilities: row[9],
seatingcapacity: row[10],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnqualification = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nqualification.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        qualification: row[0],
college: row[1],
university: row[2],
year: row[3],
regno: row[4],
council: row[5],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnexperience = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nexperience.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        position: row[0],
institution: row[1],
fromdate: row[2],
todate: row[3],
totalexperience: row[4],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnmytasks = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nmytasks.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        clientid: row[0],
client: row[1],
task: row[2],
instructions: row[3],
duedate: row[4],
staff: row[5],
staffemail: row[6],
manager: row[7],
manageremail: row[8],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadsalarydetails = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= salarydetails.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        staff: row[0],
staffemail: row[1],
item: row[2],
type: row[3],
amount: row[4],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadempapprec = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= empapprec.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
staff: row[1],
staffemail: row[2],
remarks: row[3],
reviewdate: row[4],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};



exports.uploadnlibusage = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nlibusage.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
teacherusage: row[1],
noofstudents: row[2],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


// feb820131

exports.uploadexplearning = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= explearning.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        department: row[0],
year: row[1],
programname: row[2],
programcode: row[3],
coursename: row[4],
coursecode: row[5],
type: row[6],
activity: row[7],
sname: row[8],
noofstudents: row[9],
regno: row[10],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnufacultydata = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nufacultydata.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
sancfacultystrength: row[1],
appointedfacultystrength: row[2],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadphdface = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= phdface.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        faculty: row[0],
joinyear: row[1],
ifdegree: row[2],
leftyear: row[3],
phdyear: row[4],
pgyear: row[5],
qualification: row[6],
department: row[7],
email: row[8],
empid: row[9],
gender: row[10],
designation: row[11],
joiningdate: row[12],
leavingdate: row[13],
pan: row[14],
awardinginst: row[15],
isphd: row[16],
category: row[17],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadteacherdata = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= teacherdata.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
fname: row[1],
department: row[2],
pan: row[3],
designation: row[4],
yoa: row[5],
type: row[6],
yoe: row[7],
yoeinstitution: row[8],
status: row[9],
lastyear: row[10],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadresult = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= result.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
programcode: row[1],
programname: row[2],
semester: row[3],
lastdate: row[4],
resultdate: row[5],
noofdays: row[6],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnugrievance = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nugrievance.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
studentname: row[1],
typeofgrievance: row[2],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpasspercent = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= passpercent.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
student: row[1],
regno: row[2],
ifpass: row[3],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadteacherfellow = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= teacherfellow.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
tname: row[1],
level: row[2],
award: row[3],
agency: row[4],
advanced: row[5],
duration: row[6],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpatents = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= patents.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        yop: row[0],
title: row[1],
patentnumber: row[2],
doa: row[3],
agency: row[4],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadconsultancy = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= consultancy.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        consultant: row[0],
title: row[1],
agency: row[2],
year: row[3],
revenue: row[4],
trainees: row[5],
advisor: row[6],
department: row[7],
role: row[8],
contact: row[9],
duration: row[10],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadmou = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= mou.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        bodyname: row[0],
instorgname: row[1],
year: row[2],
duration: row[3],
activity: row[4],
link: row[5],
bodytype: row[6],
purpose: row[7],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnuefacilities = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nuefacilities.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        facilities: row[0],
ifpresent: row[1],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnustudcompratio = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nustudcompratio.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        noofstudents: row[0],
noofcomputers: row[1],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadhigherexam = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= higherexam.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
regno: row[1],
studentname: row[2],
programname: row[3],
programcode: row[4],
examname: row[5],
level: row[6],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadawards = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= awards.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
awarddate: row[1],
awardname: row[2],
engagementtype: row[3],
level: row[4],
eventname: row[5],
studentname: row[6],
regno: row[7],
activitytype: row[8],
position: row[9],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


// feb 12 2013

exports.uploadnluteacherdata = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nluteacherdata.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
facultyname: row[1],
billdetails: row[2],
capacity: row[3],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnlufacilities = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nlufacilities.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        type: row[0],
ifpresent: row[1],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnlurecognitions = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nlurecognitions.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
title: row[1],
specificfield: row[2],
recogdate: row[3],
period: row[4],
body: row[5],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnlubills = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nlubills.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
facultyname: row[1],
billdetails: row[2],
organisation: row[3],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnluincentives = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nluincentives.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        type: row[0],
ifpresent: row[1],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnluphdtheisis = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nluphdtheisis.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
scholar: row[1],
theisis: row[2],
facultyname: row[3],
ifphdllm: row[4],
ipr: row[5],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnlucitation = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nlucitation.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
facultyname: row[1],
research: row[2],
agencyfund: row[3],
casefileno: row[4],
courtdetails: row[5],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnlulegaldatabases = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nlulegaldatabases.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
title: row[1],
subscriptiondate: row[2],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnlbar = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nlbar.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
studentname: row[1],
program: row[2],
council: row[3],
enrolmentno: row[4],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


// feb 19 2023

exports.uploadainst = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ainst.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        institution: row[0],
address: row[1],
pin: row[2],
establishment: row[3],
type: row[4],
category: row[5],
stream: row[6],
autonomous: row[7],
autonomyyear: row[8],
autonomyvalidity: row[9],
site: row[10],
mobile: row[11],
telephone: row[12],
othertele: row[13],
email: row[14],
website: row[15],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


//feb 200 2023


exports.uploadpauidetailsa = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= pauidetailsa.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        name: row[0],
address: row[1],
pincode: row[2],
year: row[3],
insttype: row[4],
category: row[5],
clgtype: row[6],
ifauto: row[7],
isfunct: row[8],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpauidetailsb = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= pauidetailsb.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        mobile: row[0],
landline: row[1],
other: row[2],
fax: row[3],
email: row[4],
website: row[5],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpauidetailsc = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= pauidetailsc.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        ifsectwof: row[0],
letternotwof: row[1],
dtwof: row[2],
ifsectwlfb: row[3],
letternotwlfb: row[4],
dtwlfb: row[5],
otheraccrd: row[6],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpautrust = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= pautrust.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        hod: row[0],
trustname: row[1],
address: row[2],
city: row[3],
district: row[4],
regno: row[5],
dor: row[6],
chairman: row[7],
father: row[8],
email: row[9],
mobprsnl: row[10],
officephn: row[11],
resphn: row[12],
fax: row[13],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpauprincipala = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= pauprincipala.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        name: row[0],
dob: row[1],
age: row[2],
fathername: row[3],
degree: row[4],
course: row[5],
class: row[6],
phdtitle: row[7],
address: row[8],
city: row[9],
district: row[10],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpauprincipalb = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= pauprincipalb.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        doj: row[0],
experience: row[1],
officephn: row[2],
resphn: row[3],
fax: row[4],
mobprsnl: row[5],
email: row[6],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpaugovcouncila = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= paugovcouncila.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        title: row[0],
firstname: row[1],
lastname: row[2],
position: row[3],
examqualf: row[4],
course: row[5],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpaugovcouncilb = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= paugovcouncilb.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        designation: row[0],
email: row[1],
mobprsnl: row[2],
officephn: row[3],
address: row[4],
city: row[5],
district: row[6],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpauboarda = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= pauboarda.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        title: row[0],
firstname: row[1],
lastname: row[2],
position: row[3],
examqualf: row[4],
course: row[5],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpauboardb = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= pauboardb.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        designation: row[0],
email: row[1],
mobprsnl: row[2],
officephn: row[3],
address: row[4],
city: row[5],
district: row[6],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpauragcomt = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= pauragcomt.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        position: row[0],
title: row[1],
firstname: row[2],
lastname: row[3],
designation: row[4],
email: row[5],
mobprsnl: row[6],
officephn: row[7],
address: row[8],
city: row[9],
district: row[10],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpauragsquad = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= pauragsquad.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        position: row[0],
title: row[1],
firstname: row[2],
lastname: row[3],
designation: row[4],
email: row[5],
mobprsnl: row[6],
officephn: row[7],
address: row[8],
city: row[9],
district: row[10],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpauwelfarecomt = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= pauwelfarecomt.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        position: row[0],
title: row[1],
firstname: row[2],
lastname: row[3],
designation: row[4],
email: row[5],
mobprsnl: row[6],
officephn: row[7],
address: row[8],
city: row[9],
district: row[10],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpauredressal = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= pauredressal.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        position: row[0],
title: row[1],
firstname: row[2],
lastname: row[3],
designation: row[4],
email: row[5],
mobprsnl: row[6],
officephn: row[7],
address: row[8],
city: row[9],
district: row[10],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpaubankacnts = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= paubankacnts.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        acctype: row[0],
bank: row[1],
branch: row[2],
accno: row[3],
ifsccode: row[4],
baleol: row[5],
bal: row[6],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpaudeposit = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= paudeposit.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        deptype: row[0],
instname: row[1],
branch: row[2],
refno: row[3],
amount: row[4],
dom: row[5],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpauendowment = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= pauendowment.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        created: row[0],
bank: row[1],
branch: row[2],
amount: row[3],
instrumentno: row[4],
instrumentdate: row[5],
expdate: row[6],
finreserve: row[7],
expenditure: row[8],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpaulanddetailsa = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= paulanddetailsa.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        type: row[0],
location: row[1],
district: row[2],
taluk: row[3],
village: row[4],
place: row[5],
pincode: row[6],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpaulanddetailsb = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= paulanddetailsb.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        landext: row[0],
docno: row[1],
dol: row[2],
surveyno: row[3],
extent: row[4],
totalextland: row[5],
totalextbuilt: row[6],
deficiency: row[7],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpaucourse = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= paucourse.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        department: row[0],
degree: row[1],
course: row[2],
yoi: row[3],
afflnature: row[4],
fromdate: row[5],
todate: row[6],
letterno: row[7],
letterdt: row[8],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpaucrsedetails = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= paucrsedetails.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        degree: row[0],
course: row[1],
sancintake: row[2],
admtintake: row[3],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpauaddcrse = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= pauaddcrse.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        degree: row[0],
course: row[1],
admtintake: row[2],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpaustuddetails = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= paustuddetails.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        degree: row[0],
course: row[1],
sancintake: row[2],
boys: row[3],
girls: row[4],
totalstud: row[5],
religion: row[6],
relgboys: row[7],
relggirls: row[8],
community: row[9],
comboys: row[10],
comgirls: row[11],
nationality: row[12],
boys: row[13],
girls: row[14],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpaufaculty = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= paufaculty.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        college: row[0],
department: row[1],
course: row[2],
afcode: row[3],
fname: row[4],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpaufdetailsa = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= paufdetailsa.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        name: row[0],
department: row[1],
degrencrse: row[2],
faculty: row[3],
ifregular: row[4],
image: row[5],
designation: row[6],
resadrs1: row[7],
resadrs2: row[8],
district: row[9],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpaufdetailsb = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= paufdetailsb.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        phone: row[0],
mobile: row[1],
email: row[2],
gender: row[3],
community: row[4],
pan: row[5],
passport: row[6],
adhar: row[7],
fcodecoe: row[8],
fcodeaicte: row[9],
dob: row[10],
age: row[11],
payscale: row[12],
basicpay: row[13],
emoluments: row[14],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpaufeduqualif = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= paufeduqualif.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        category: row[0],
degree: row[1],
spclztn: row[2],
yop: row[3],
colgname: row[4],
univname: row[5],
marks: row[6],
class: row[7],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpaufaddqualif = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= paufaddqualif.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        score: row[0],
file: row[1],
title: row[2],
fphdaward: row[3],
yoe: row[4],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpaufacdexp = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= paufacdexp.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        college: row[0],
designation: row[1],
doj: row[2],
dol: row[3],
expinyears: row[4],
expinmonths: row[5],
expindays: row[6],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpaufindexp = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= paufindexp.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        orgname: row[0],
designation: row[1],
worknature: row[2],
doj: row[3],
dol: row[4],
expinyears: row[5],
expinmonths: row[6],
expindays: row[7],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpaufcoeexp = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= paufcoeexp.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        aur: row[0],
squadmember: row[1],
extexaminer: row[2],
eval: row[3],
reeval: row[4],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpauconfacshe = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= pauconfacshe.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        designation: row[0],
course: row[1],
nooffac: row[2],
intake: row[3],
reqfac: row[4],
deficiency: row[5],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpauconfaccourse = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= pauconfaccourse.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        degree: row[0],
course: row[1],
totsanc: row[2],
itype: row[3],
req: row[4],
avail: row[5],
deficiency: row[6],
cdeficient: row[7],
ssr: row[8],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpauconfacmemtech = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= pauconfacmemtech.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        degree: row[0],
course: row[1],
totsanc: row[2],
type: row[3],
req: row[4],
avail: row[5],
deficiency: row[6],
cdeficient: row[7],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpaunontstaff = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= paunontstaff.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        category: row[0],
department: row[1],
title: row[2],
firstname: row[3],
lastname: row[4],
designation: row[5],
qualification: row[6],
doj: row[7],
prevexpinyear: row[8],
dob: row[9],
age: row[10],
sofpay: row[11],
pbaspay: row[12],
emoluments: row[13],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpauspacereq = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= pauspacereq.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        degree: row[0],
course: row[1],
labstudio: row[2],
labname: row[3],
arealabreq: row[4],
arealabavail: row[5],
deficiency: row[6],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpauequip = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= pauequip.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        degree: row[0],
course: row[1],
semester: row[2],
regulation: row[3],
noflabsub: row[4],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpauequiplist = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= pauequiplist.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        equipname: row[0],
quant: row[1],
availquant: row[2],
deficiency: row[3],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpauccomfarea = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= pauccomfarea.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        reqarea: row[0],
availarea: row[1],
deficiency: row[2],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpautermlanwan = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= pautermlanwan.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        course: row[0],
intake: row[1],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpaunoofterm = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= paunoofterm.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        req: row[0],
avail: row[1],
deficiency: row[2],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpaunooftermlan = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= paunooftermlan.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        req: row[0],
avail: row[1],
deficiency: row[2],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpaunoofprinters = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= paunoofprinters.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        req: row[0],
avail: row[1],
deficiency: row[2],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpausoftware = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= pausoftware.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        softreq: row[0],
availsoft: row[1],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpaunetwork = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= paunetwork.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        intake: row[0],
reqband: row[1],
availband: row[2],
noofnodes: row[3],
deficiency: row[4],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpaulibarea = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= paulibarea.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        institute: row[0],
parea: row[1],
availarea: row[2],
deficiency: row[3],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpaulibbooks = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= paulibbooks.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        type: row[0],
req: row[1],
avail: row[2],
deficiency: row[3],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpaulibjournal = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= paulibjournal.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        degree: row[0],
course: row[1],
type: row[2],
req: row[3],
avail: row[4],
deficiency: row[5],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpauavailclroom = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= pauavailclroom.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        name: row[0],
area: row[1],
noofroom: row[2],
latitude: row[3],
longitude: row[4],
type: row[5],
capacity: row[6],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpausumofclroom = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= pausumofclroom.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        req: row[0],
avail: row[1],
deficiency: row[2],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpaunoofdrawhall = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= paunoofdrawhall.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        degree: row[0],
reqhalls: row[1],
availhalls: row[2],
deficiency: row[3],
reqdrawarea: row[4],
avladrawarea: row[5],
deficiency: row[6],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpauadminarea = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= pauadminarea.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        buildspace: row[0],
carparea: row[1],
avail: row[2],
deficiency: row[3],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpauamen = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= pauamen.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        buildspace: row[0],
oneprog: row[1],
avail: row[2],
deficiency: row[3],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpaubhostel = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= paubhostel.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        bhostel: row[0],
hostelbuild: row[1],
lochostel: row[2],
distofcol: row[3],
totadmitstrn: row[4],
blname: row[5],
room: row[6],
carea: row[7],
noofreqroom: row[8],
availroom: row[9],
caproom: row[10],
availcaproom: row[11],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpaughostel = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= paughostel.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        ghostel: row[0],
hostelbuild: row[1],
lochostel: row[2],
distofcol: row[3],
totadmitstrn: row[4],
blname: row[5],
room: row[6],
carea: row[7],
noofreqroom: row[8],
availroom: row[9],
caproom: row[10],
availcaproom: row[11],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpauotherbuildarea = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= pauotherbuildarea.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        areadescrip: row[0],
reqcarparea: row[1],
availcarparea: row[2],
deficiency: row[3],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpauphyedu = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= pauphyedu.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        description: row[0],
details: row[1],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpautpc = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= pautpc.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        title: row[0],
firstname: row[1],
lastname: row[2],
designation: row[3],
department: row[4],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpaufacilityavail = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= paufacilityavail.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        item: row[0],
avail: row[1],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpaualumni = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= paualumni.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        item: row[0],
avail: row[1],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpautpc = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= pautpc.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        name: row[0],
firstname: row[1],
lastname: row[2],
designation: row[3],
department: row[4],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpauhealth = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= pauhealth.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        title: row[0],
firstname: row[1],
lastname: row[2],
designation: row[3],
qualification: row[4],
experience: row[5],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpauothamen = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= pauothamen.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        amen: row[0],
avail: row[1],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpauregrec = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= pauregrec.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        regname: row[0],
maintained: row[1],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpaucertificates = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= paucertificates.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        certiname: row[0],
avail: row[1],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpauprocfeea = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= pauprocfeea.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        coursename: row[0],
noofcourse: row[1],
inspecfee: row[2],
totam: row[3],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpauprocfeeb = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= pauprocfeeb.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        amount: row[0],
utrno: row[1],
dof: row[2],
bankname: row[3],
branch: row[4],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpauprocfeec = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= pauprocfeec.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        nofbankwithbranch: row[0],
accno: row[1],
accname: row[2],
ifsccode: row[3],
micrcode: row[4],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpauprcplendrsmnt = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= pauprcplendrsmnt.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        endorse: row[0],
place: row[1],
dos: row[2],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpaumngdeclaration = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= paumngdeclaration.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        declaration: row[0],
place: row[1],
dos: row[2],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


// feb 22 2023

exports.uploadpnirf = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= pnirf.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        nirf: row[0],
year: row[1],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpadmnew = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= padmnew.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
sanctioned: row[1],
firstyear: row[2],
secondyear: row[3],
thirdyear: row[4],
fourthyear: row[5],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpnbanew = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= pnbanew.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
program: row[1],
programcode: row[2],
isnba: row[3],
anyother: row[4],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpaunfcoeexp = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= paunfcoeexp.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        aur: row[0],
squadmember: row[1],
extexaminer: row[2],
evalscripts: row[3],
reeval: row[4],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpaunprincipala = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= paunprincipala.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        name: row[0],
dob: row[1],
age: row[2],
fathername: row[3],
degree: row[4],
course: row[5],
classobt: row[6],
phdtitle: row[7],
address: row[8],
city: row[9],
district: row[10],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpaunfeduqualif = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= paunfeduqualif.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        category: row[0],
degree: row[1],
spclztn: row[2],
yop: row[3],
colgname: row[4],
univname: row[5],
marks: row[6],
classobt: row[7],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpaunhealth = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= paunhealth.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        title: row[0],
firstname: row[1],
lastname: row[2],
designation: row[3],
qualification: row[4],
experience: row[5],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpaunnoofdrawhall = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= paunnoofdrawhall.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        degree: row[0],
reqhalls: row[1],
availhalls: row[2],
deficiency: row[3],
reqdrawarea: row[4],
avladrawarea: row[5],
deficiencydraw: row[6],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpaunstuddetails = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= paunstuddetails.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        degree: row[0],
course: row[1],
sancintake: row[2],
boys: row[3],
girls: row[4],
totalstud: row[5],
religion: row[6],
relgboys: row[7],
relggirls: row[8],
community: row[9],
comboys: row[10],
comgirls: row[11],
nationality: row[12],
natboys: row[13],
natgirls: row[14],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


// feb 24 2023

exports.uploadpaunnprincipal = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= paunnprincipal.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        name: row[0],
dob: row[1],
age: row[2],
fathername: row[3],
degree: row[4],
course: row[5],
classobt: row[6],
phdtitle: row[7],
doj: row[8],
experience: row[9],
officephn: row[10],
resphn: row[11],
fax: row[12],
mobprsnl: row[13],
email: row[14],
address: row[15],
city: row[16],
district: row[17],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpaungovcouncil = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= paungovcouncil.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        title: row[0],
firstname: row[1],
lastname: row[2],
position: row[3],
examqualf: row[4],
course: row[5],
designation: row[6],
email: row[7],
mobprsnl: row[8],
officephn: row[9],
address: row[10],
city: row[11],
district: row[12],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpaunboard = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= paunboard.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        title: row[0],
firstname: row[1],
lastname: row[2],
position: row[3],
examqualf: row[4],
course: row[5],
designation: row[6],
email: row[7],
mobprsnl: row[8],
officephn: row[9],
address: row[10],
city: row[11],
district: row[12],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpaunprocfee = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= paunprocfee.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        coursename: row[0],
noofcourse: row[1],
inspecfee: row[2],
totam: row[3],
amount: row[4],
utrno: row[5],
dof: row[6],
bankname: row[7],
branch: row[8],
nofbankwithbranch: row[9],
accno: row[10],
accname: row[11],
ifsccode: row[12],
micrcode: row[13],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpauntermlanwan = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= pauntermlanwan.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        course: row[0],
intake: row[1],
reqnoofterm: row[2],
availnoofterm: row[3],
defnoofterm: row[4],
reqnooftermlan: row[5],
availnooftermlan: row[6],
defnooftermlan: row[7],
reqnoofprinters: row[8],
availnoofprinters: row[9],
defnoofprinters: row[10],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpaunidetails = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= paunidetails.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        name: row[0],
address: row[1],
pincode: row[2],
year: row[3],
insttype: row[4],
category: row[5],
clgtype: row[6],
ifauto: row[7],
isfunct: row[8],
mobile: row[9],
landline: row[10],
other: row[11],
fax: row[12],
email: row[13],
website: row[14],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpaunfacultydetails = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= paunfacultydetails.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        college: row[0],
department: row[1],
degrencrse: row[2],
faculty: row[3],
ifregular: row[4],
designation: row[5],
resadrs1: row[6],
resadrs2: row[7],
district: row[8],
phone: row[9],
mobile: row[10],
email: row[11],
gender: row[12],
community: row[13],
pan: row[14],
passport: row[15],
adhar: row[16],
fcodecoe: row[17],
fcodeaicte: row[18],
dob: row[19],
age: row[20],
payscale: row[21],
basicpay: row[22],
emoluments: row[23],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpaunfaddqualif = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= paunfaddqualif.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        faculty: row[0],
email: row[1],
score: row[2],
file: row[3],
title: row[4],
fphdaward: row[5],
yoe: row[6],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpaunfacdexp = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= paunfacdexp.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        faculty: row[0],
email: row[1],
college: row[2],
designation: row[3],
doj: row[4],
dol: row[5],
expinyears: row[6],
expinmonths: row[7],
expindays: row[8],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpaunfindexp = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= paunfindexp.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        faculty: row[0],
email: row[1],
orgname: row[2],
designation: row[3],
worknature: row[4],
doj: row[5],
dol: row[6],
expinyears: row[7],
expinmonths: row[8],
expindays: row[9],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpaunnfeduqualif = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= paunnfeduqualif.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        faculty: row[0],
email: row[1],
category: row[2],
degree: row[3],
spclztn: row[4],
yop: row[5],
colgname: row[6],
univname: row[7],
marks: row[8],
classobt: row[9],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpaunnfcoeexp = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= paunnfcoeexp.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        faculty: row[0],
email: row[1],
aur: row[2],
squadmember: row[3],
extexaminer: row[4],
evalscripts: row[5],
reeval: row[6],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpaunadminarea = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= paunadminarea.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        buildspace: row[0],
carparea: row[1],
avail: row[2],
deficiency: row[3],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpaunamen = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= paunamen.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        buildspace: row[0],
noofrooms: row[1],
spacereq: row[2],
avail: row[3],
deficiency: row[4],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpaunotherbuildarea = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= paunotherbuildarea.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        areadescrip: row[0],
noofrooms: row[1],
reqcarparea: row[2],
availcarparea: row[3],
deficiency: row[4],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


// feb 25 2023

exports.uploadpaunlibbooks = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= paunlibbooks.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        volreq: row[0],
volavail: row[1],
voldef: row[2],
titlereq: row[3],
titleavail: row[4],
titledef: row[5],
voladdreq: row[6],
voladdavail: row[7],
voladddef: row[8],
totalreq: row[9],
totalavail: row[10],
totaldef: row[11],
alldef: row[12],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpaunewidetails = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= paunewidetails.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        college: row[0],
address: row[1],
pincode: row[2],
year: row[3],
insttype: row[4],
category: row[5],
clgtype: row[6],
ifauto: row[7],
isfunct: row[8],
mobile: row[9],
landline: row[10],
other: row[11],
fax: row[12],
email: row[13],
website: row[14],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpaunewprincipal = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= paunewprincipal.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        principal: row[0],
dob: row[1],
age: row[2],
fathername: row[3],
degree: row[4],
course: row[5],
classobt: row[6],
phdtitle: row[7],
doj: row[8],
experience: row[9],
officephn: row[10],
resphn: row[11],
fax: row[12],
mobprsnl: row[13],
email: row[14],
address: row[15],
city: row[16],
district: row[17],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpauclassblock = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= pauclassblock.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        blockname: row[0],
blockarea: row[1],
noofroom: row[2],
rooftype: row[3],
capacity: row[4],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpauclassnew = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= pauclassnew.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        classroom: row[0],
area: row[1],
latitude: row[2],
longitude: row[3],
capacity: row[4],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpaunlibjournal = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= paunlibjournal.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        degree: row[0],
course: row[1],
natreq: row[2],
natavail: row[3],
natdef: row[4],
intnreq: row[5],
intnavail: row[6],
intndef: row[7],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


// feb 27 2023 1

exports.uploadpaunewfacultydetails = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= paunewfacultydetails.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        college: row[0],
department: row[1],
degrencrse: row[2],
faculty: row[3],
ifregular: row[4],
designation: row[5],
resadrs1: row[6],
resadrs2: row[7],
district: row[8],
phone: row[9],
mobile: row[10],
email: row[11],
gender: row[12],
community: row[13],
pan: row[14],
passport: row[15],
adhar: row[16],
fcodecoe: row[17],
fcodeaicte: row[18],
dob: row[19],
age: row[20],
payscale: row[21],
basicpay: row[22],
emoluments: row[23],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpaunewfaddqualif = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= paunewfaddqualif.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        faculty: row[0],
email: row[1],
mobile: row[2],
score: row[3],
file: row[4],
title: row[5],
fphdaward: row[6],
yoe: row[7],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpaunewfacdexp = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= paunewfacdexp.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        faculty: row[0],
email: row[1],
mobile: row[2],
college: row[3],
designation: row[4],
doj: row[5],
dol: row[6],
expinyears: row[7],
expinmonths: row[8],
expindays: row[9],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpaunewfindexp = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= paunewfindexp.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        faculty: row[0],
email: row[1],
mobile: row[2],
orgname: row[3],
designation: row[4],
worknature: row[5],
doj: row[6],
dol: row[7],
expinyears: row[8],
expinmonths: row[9],
expindays: row[10],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpaunewfeduqualif = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= paunewfeduqualif.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        faculty: row[0],
email: row[1],
mobile: row[2],
category: row[3],
degree: row[4],
spclztn: row[5],
yop: row[6],
colgname: row[7],
univname: row[8],
marks: row[9],
classobt: row[10],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpaunewlanddetails = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= paunewlanddetails.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        type: row[0],
location: row[1],
district: row[2],
taluk: row[3],
village: row[4],
place: row[5],
pincode: row[6],
landext: row[7],
docno: row[8],
dol: row[9],
surveyno: row[10],
extent: row[11],
totalextland: row[12],
totalextbuilt: row[13],
deficiency: row[14],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


// feb 28 2023 1

exports.uploadpauinstdetails = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= pauinstdetails.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        instcode: row[0],
instname: row[1],
courseid: row[2],
coursetype: row[3],
crsename: row[4],
degree: row[5],
yos: row[6],
firstyi: row[7],
secondyi: row[8],
thirdyi: row[9],
fourthyi: row[10],
fifthyi: row[11],
totalintk: row[12],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpauinstcourse = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= pauinstcourse.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        instname: row[0],
ug: row[1],
pg: row[2],
total: row[3],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpaunequip = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= paunequip.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        degree: row[0],
course: row[1],
semester: row[2],
regulation: row[3],
noflabsub: row[4],
equipname: row[5],
quant: row[6],
availquant: row[7],
deficiency: row[8],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpaunewfcoeexp = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= paunewfcoeexp.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        faculty: row[0],
email: row[1],
mobile: row[2],
aur: row[3],
squadmember: row[4],
extexaminer: row[5],
evalscripts: row[6],
reeval: row[7],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


// mar 2 2023

exports.uploadainsmaster = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ainsmaster.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        instcode: row[0],
insname: row[1],
firstyear: row[2],
secondyear: row[3],
thirdyear: row[4],
fourthyear: row[5],
fifthyear: row[6],
total: row[7],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};



// mar 7 2023

exports.uploadnuexplearning = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nuexplearning.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
programname: row[1],
coursename: row[2],
coursecode: row[3],
components: row[4],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnucodeofethics = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nucodeofethics.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        statedcodeofethics: row[0],
ifpresent: row[1],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnlufocus = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nlufocus.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
programname: row[1],
coursename: row[2],
focus: row[3],
ifnew: row[4],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnluadmission = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nluadmission.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
programname: row[1],
sancseat: row[2],
admtdseat: row[3],
rsrvcatsanc: row[4],
rsrvcatadmtd: row[5],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnauscholarship = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nauscholarship.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
title: row[1],
sname: row[2],
amount: row[3],
type: row[4],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


// mar 13 2023

exports.uploadppuclgdetails = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ppuclgdetails.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        clgnameadrs: row[0],
phone: row[1],
email: row[2],
yoe: row[3],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadppuheaddetails = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ppuheaddetails.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        headname: row[0],
designation: row[1],
emailphone: row[2],
address: row[3],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadppulegalrep = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ppulegalrep.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        legalrep: row[0],
address: row[1],
telephone: row[2],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpputrustdetails = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= pputrustdetails.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        trustnameadrs: row[0],
regno: row[1],
dor: row[2],
familytrust: row[3],
chairman: row[4],
secretary: row[5],
emailphone: row[6],
resadrsphone: row[7],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadppupermission = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ppupermission.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        letterno: row[0],
doi: row[1],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadppumanagingbody = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ppumanagingbody.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        bodyname: row[0],
address: row[1],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadppuwlfcomt = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ppuwlfcomt.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        isfunct: row[0],
normsavl: row[1],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpputrustfin = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= pputrustfin.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        banker: row[0],
branch: row[1],
accno: row[2],
balonye: row[3],
balondate: row[4],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadppufdrdetails = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ppufdrdetails.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        branch: row[0],
amount: row[1],
dom: row[2],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadppuimmvprop = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ppuimmvprop.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        survno: row[0],
landext: row[1],
location: row[2],
details: row[3],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadppufinance = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ppufinance.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        endowmntcrtd: row[0],
pan: row[1],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadppuland = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ppuland.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        docno: row[0],
dor: row[1],
surveyno: row[2],
extent: row[3],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadppubuilding = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ppubuilding.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        description: row[0],
size: row[1],
quantity: row[2],
rooftype: row[3],
amendetail: row[4],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadppuhostel = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ppuhostel.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        type: row[0],
noofblocks: row[1],
location: row[2],
noofstaff: row[3],
noofcomroom: row[4],
noofreadroom: row[5],
noofrecroom: row[6],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadppurooms = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ppurooms.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        type: row[0],
area: row[1],
noofrooms: row[2],
noofstudacmd: row[3],
totalarea: row[4],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadppuphyedu = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ppuphyedu.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        dirname: row[0],
qualiexp: row[1],
noofattndr: row[2],
attndrname: row[3],
totalarea: row[4],
outgames: row[5],
ingames: row[6],
gym: row[7],
funds: row[8],
itemsncost: row[9],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadppustaff = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ppustaff.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        designation: row[0],
noofstaff: row[1],
area: row[2],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadppucollege = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ppucollege.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        clgname: row[0],
clgadrs: row[1],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpputrust = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= pputrust.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        trustname: row[0],
trustadrs: row[1],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadppuaddprog = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ppuaddprog.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        degree: row[0],
progname: row[1],
sancstrngth: row[2],
recgnodate: row[3],
remarks: row[4],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadppuvarintake = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ppuvarintake.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        degree: row[0],
progname: row[1],
prevsancstrngth: row[2],
revsancstrngth: row[3],
noc: row[4],
recgnodate: row[5],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadppuexistprog = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ppuexistprog.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        department: row[0],
degree: row[1],
progname: row[2],
prevsancstrngth: row[3],
admtdstud: row[4],
minstaprvnodate: row[5],
univafflnodate: row[6],
yob: row[7],
yoi: row[8],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadppucourses = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ppucourses.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        degree: row[0],
progname: row[1],
sancstrngth: row[2],
studonroll: row[3],
startdate: row[4],
affil: row[5],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadppucoursrep = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ppucoursrep.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        ifbreak: row[0],
brkdetails: row[1],
instful: row[2],
ifcomplrep: row[3],
complrepdetails: row[4],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadppuprincipal = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ppuprincipal.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        degree: row[0],
yop: row[1],
marksobt: row[2],
univname: row[3],
spclz: row[4],
dob: row[5],
age: row[6],
doj: row[7],
yearsofexpprof: row[8],
yearsofexpind: row[9],
totalexp: row[10],
totalpay: row[11],
ifqualpernorms: row[12],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadppufaculty = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ppufaculty.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        department: row[0],
faculty: row[1],
designation: row[2],
qualification: row[3],
marksobt: row[4],
degree: row[5],
spclz: row[6],
yearsofexpprof: row[7],
yearsofexpind: row[8],
dob: row[9],
doj: row[10],
payscale: row[11],
basicpay: row[12],
emoluments: row[13],
univaprvl: row[14],
ifqualpernorms: row[15],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadppustafstudratio = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ppustafstudratio.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        department: row[0],
program: row[1],
sancstrength: row[2],
totalstaff: row[3],
ratio: row[4],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadppulabequip = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ppulabequip.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        department: row[0],
degree: row[1],
program: row[2],
labname: row[3],
equipname: row[4],
quantity: row[5],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadppulabequipprocure = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ppulabequipprocure.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        department: row[0],
degree: row[1],
program: row[2],
labname: row[3],
equipname: row[4],
quantity: row[5],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadppulecturerooms = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ppulecturerooms.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
noofclsroom: row[1],
nooflabroom: row[2],
floorspace: row[3],
reqfurniture: row[4],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadppuavailclsroom = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ppuavailclsroom.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        ifroomavl: row[0],
planroom: row[1],
floorspcefurn: row[2],
funds: row[3],
reason: row[4],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadppunetwork = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ppunetwork.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        bandwidth: row[0],
noofterm: row[1],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadppucompfaci = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ppucompfaci.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        department: row[0],
degree: row[1],
program: row[2],
sancstrngth: row[3],
noofterminals: row[4],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadppucompsoftware = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ppucompsoftware.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        software: row[0],
typeoflicense: row[1],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadppucompaddinfo = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ppucompaddinfo.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        ifupdates: row[0],
ifaddcomp: row[1],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadppucompaddsoft = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ppucompaddsoft.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        software: row[0],
typeoflicense: row[1],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadppulibrary = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ppulibrary.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        totalarea: row[0],
librarian: row[1],
qualiexp: row[2],
spclfaci: row[3],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadppulibstaff = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ppulibstaff.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        staffname: row[0],
designation: row[1],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadppulibbooks = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ppulibbooks.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        department: row[0],
degree: row[1],
coursename: row[2],
noofbooks: row[3],
noofrefbooks: row[4],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadppulibindjrnl = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ppulibindjrnl.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        department: row[0],
degree: row[1],
coursename: row[2],
title: row[3],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadppulibforgjrnl = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ppulibforgjrnl.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        department: row[0],
degree: row[1],
coursename: row[2],
title: row[3],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadppulibautomation = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ppulibautomation.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        isautomated: row[0],
system: row[1],
catlgsystem: row[2],
facility: row[3],
libtime: row[4],
holiday: row[5],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadppulibprocure = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ppulibprocure.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        ifprocured: row[0],
dop: row[1],
ordercopy: row[2],
noofcopy: row[3],
noofaddbook: row[4],
noofaddjournal: row[5],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadppulibexp = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ppulibexp.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
propexp: row[1],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadppustudfaci = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ppustudfaci.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        type: row[0],
ifavlboys: row[1],
ifavlgirls: row[2],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadppuotherfaci = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ppuotherfaci.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        type: row[0],
details: row[1],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadppumedservice = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ppumedservice.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        doctorname: row[0],
qualification: row[1],
spclz: row[2],
address: row[3],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadppuaudvidequip = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ppuaudvidequip.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        equipname: row[0],
details: row[1],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadppuclubs = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ppuclubs.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        clubname: row[0],
details: row[1],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpputechstaff = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= pputechstaff.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        staffname: row[0],
designation: row[1],
eduqualif: row[2],
dob: row[3],
doj: row[4],
payscale: row[5],
emoluments: row[6],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadppuminststaff = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ppuminststaff.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        staffname: row[0],
designation: row[1],
eduqualif: row[2],
dob: row[3],
doj: row[4],
payscale: row[5],
emoluments: row[6],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadppuaddinfo = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ppuaddinfo.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        type: row[0],
details: row[1],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadppudeclaration = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ppudeclaration.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        declaration: row[0],
place: row[1],
dod: row[2],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadppucertificates = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ppucertificates.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        type: row[0],
ifavl: row[1],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadppuaddinfoprog = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ppuaddinfoprog.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        type: row[0],
details: row[1],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadppuaddinfonoc = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ppuaddinfonoc.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        type: row[0],
daterefno: row[1],
doa: row[2],
expdate: row[3],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadppuaddinfopermission = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ppuaddinfopermission.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        type: row[0],
daterefno: row[1],
doa: row[2],
expdate: row[3],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadppuaddinfobos = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ppuaddinfobos.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        type: row[0],
details: row[1],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadppuaddinfosyllabi = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ppuaddinfosyllabi.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        type: row[0],
details: row[1],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadppuaddinfofac = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ppuaddinfofac.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        type: row[0],
details: row[1],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadppuaddinfostaffdetails = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ppuaddinfostaffdetails.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
designation: row[1],
quantity: row[2],
qualiexp: row[3],
toa: row[4],
payscale: row[5],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadppuaddfacdetails = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ppuaddfacdetails.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        department: row[0],
faculty: row[1],
designation: row[2],
qualification: row[3],
marksobt: row[4],
degree: row[5],
spclz: row[6],
yearsofexpprof: row[7],
yearsofexpind: row[8],
dob: row[9],
doj: row[10],
payscale: row[11],
basicpay: row[12],
emoluments: row[13],
univaprvl: row[14],
ifqualpernorms: row[15],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadppufacworkload = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ppufacworkload.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        type: row[0],
workload: row[1],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};

// mar 14 2023

exports.uploadhostel = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= hostel.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        building: row[0],
room: row[1],
type: row[2],
noofbeds: row[3],
fees: row[4],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


// mar 15 2023

exports.uploadpaunfacnew = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= paunfacnew.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        college: row[0],
department: row[1],
degrencrse: row[2],
faculty: row[3],
ifregular: row[4],
designation: row[5],
resadrs1: row[6],
resadrs2: row[7],
district: row[8],
phone: row[9],
mobile: row[10],
email: row[11],
gender: row[12],
community: row[13],
pan: row[14],
passport: row[15],
adhar: row[16],
fcodecoe: row[17],
fcodeaicte: row[18],
dob: row[19],
age: row[20],
payscale: row[21],
basicpay: row[22],
emoluments: row[23],
level: row[24],
group: row[25],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpauprncplphd = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= pauprncplphd.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        principal: row[0],
mobprsnl: row[1],
email: row[2],
sname: row[3],
sregno: row[4],
university: row[5],
yor: row[6],
yod: row[7],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpauprncplpub = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= pauprncplpub.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        principal: row[0],
mobprsnl: row[1],
email: row[2],
title: row[3],
journal: row[4],
yop: row[5],
issn: row[6],
articlelink: row[7],
journallink: row[8],
ugclisted: row[9],
hindex: row[10],
citation: row[11],
citationindex: row[12],
level: row[13],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


// mar 16 2023

exports.uploadainscom = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ainscom.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        designation: row[0],
name: row[1],
profposition: row[2],
department: row[3],
institution: row[4],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadafaccadre = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= afaccadre.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        program: row[0],
programcode: row[1],
level: row[2],
cadre: row[3],
required: row[4],
available: row[5],
deficiency: row[6],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadaequipments = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= aequipments.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        program: row[0],
programcode: row[1],
equipment: row[2],
type: row[3],
required: row[4],
available: row[5],
deficiency: row[6],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


// exports.uploadawards = function(req, res) {
//     //console.log('processing file upload');
    
//     upload(req,res,function(err) {
//         if(err) {
//             //console.log("Error uploading file." + err.toString());
//             return res.end("Error uploading file." + err.toString());
//         }
//         const name=req.body.name;
//         const colid=req.body.colid;
//         //console.log('files ' + req.files);
//         const user1=req.body.user;
//         const token=req.body.token;
//         //console.log('token ' + token);
//         let jwtuser='';
//         let jwtcolid='';
//         try {
//             const verified = jwt.verify(
//                 token,
//                 process.env.JWT_SECRET,
//                 (err123, verified) => {
//                   if (err123) {
//                     return res.status(401).json({
//                         status: 'Unauthorized',
//                         error: err123
//                     });
//                   }
//                   jwtuser=verified.user;
//                   jwtcolid=verified.colid;
//                   return verified;
//                 }
//               );
//               //console.log(verified);
    
//         } catch(err1234) {
//             //console.log(err1234);
//         }
//         //console.log('token verified ' + jwtuser + '-' + jwtcolid);

//         try {
//             let path1="public/img/users/" + req.file.filename;
//             //console.log(path1);
//             readXlsxFile(path1).then((rows) => {
//                 // skip header
//                 rows.shift();
      
//                 let tutorials = [];
      
//                 rows.forEach((row) => {
//                     const pat1= awards.create({
//                         colid: colid,
//                         user: user1,
//                         name: name,
//                         year: row[0],
// awarddate: row[1],
// awardname: row[2],
// engagementtype: row[3],
// level: row[4],
// eventname: row[5],
// studentname: row[6],
// regno: row[7],
// activitytype: row[8],
// position: row[9],
// status1: 'Submitted',
//                         comments: 'NA'
                    
//                     });

                    
      
//               //tutorials.push(tutorial);
//                 });
//             });
//             //console.log('uploaded');
//             res.status(401).json({
//                 status: 'Success'
//             });
//         } catch(err1) {
//             res.status(401).json({
//                 status: 'Error',
//                 error: err1
//             });

//         }

//     });
// };

exports.uploadawardsnew = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= awardsnew.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
awarddate: row[1],
awardname: row[2],
type: row[3],
level: row[4],
eventname: row[5],
studentname: row[6],
regno: row[7],
activitytype: row[8],
position: row[9],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


// mar 16 2023

exports.uploadanlibjournals = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= anlibjournals.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        program: row[0],
programcode: row[1],
natreq: row[2],
natavail: row[3],
interreq: row[4],
interavail: row[5],
natdef: row[6],
interdef: row[7],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


// mar 18 2023

exports.uploadvacstudents = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= vacstudents.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        program: row[0],
programcode: row[1],
year: row[2],
student: row[3],
regno: row[4],
admissionyear: row[5],
ifcompleted: row[6],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


// mar 21 2023

exports.uploadninvoicenew = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ninvoicenew.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        clientid: row[0],
client: row[1],
amount: row[2],
gst: row[3],
total: row[4],
duedate: row[5],
bank: row[6],
account: row[7],
ifsc: row[8],
paybank: row[9],
paydate: row[10],
refno: row[11],
mode: row[12],
project: row[13],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadninvoiceitems = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ninvoiceitems.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        invoiceid: row[0],
item: row[1],
hsnsac: row[2],
sale: row[3],
cgst: row[4],
sgst: row[5],
igst: row[6],
samestate: row[7],
total: row[8],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


// mar 21 2023 1

exports.uploadninvoicen = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ninvoicen.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        clientid: row[0],
client: row[1],
amount: row[2],
cgst: row[3],
sgst: row[4],
igst: row[5],
total: row[6],
duedate: row[7],
bank: row[8],
account: row[9],
ifsc: row[10],
paybank: row[11],
paydate: row[12],
refno: row[13],
mode: row[14],
project: row[15],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


// mar 21 2023 2

exports.uploadninvoicefinal = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ninvoicefinal.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        clientid: row[0],
client: row[1],
amount: row[2],
cgst: row[3],
sgst: row[4],
igst: row[5],
total: row[6],
duedate: row[7],
bank: row[8],
account: row[9],
ifsc: row[10],
paybank: row[11],
paydate: row[12],
refno: row[13],
mode: row[14],
received: row[15],
tds: row[16],
project: row[17],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};

// mar 23 2023

exports.uploadninvoicefnew = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ninvoicefnew.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        orgid: row[0],
orgname: row[1],
invno: row[2],
clientid: row[3],
client: row[4],
amount: row[5],
cgst: row[6],
sgst: row[7],
igst: row[8],
total: row[9],
duedate: row[10],
bank: row[11],
account: row[12],
ifsc: row[13],
paybank: row[14],
paydate: row[15],
refno: row[16],
mode: row[17],
received: row[18],
tds: row[19],
project: row[20],
invstatus: row[21],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnorgdetails = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= norgdetails.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        organization: row[0],
address: row[1],
state: row[2],
country: row[3],
pin: row[4],
pan: row[5],
gst: row[6],
tan: row[7],
gstapplicable: row[8],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


// mar 26 2023

exports.uploadnstatus = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nstatus.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        criteria: row[0],
metric: row[1],
department: row[2],
lastchecked: row[3],
status: row[4],
issues: row[5],
nextct: row[6],
nextins: row[7],
targetct: row[8],
targetins: row[9],
plandate: row[10],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnprojects = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nprojects.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        project: row[0],
task: row[1],
subtask: row[2],
duedate: row[3],
assignedto: row[4],
status: row[5],
issues: row[6],
dependencyid: row[7],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


// mar 26 2023 1

exports.uploadnprojectsnew = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nprojectsnew.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        project: row[0],
task: row[1],
subtask: row[2],
startdate: row[3],
duedate: row[4],
assignedto: row[5],
status: row[6],
percent: row[7],
issues: row[8],
dependencyid: row[9],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


// mar 29 2023

exports.uploadinnovationnew = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= innovationnew.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        department: row[0],
year: row[1],
title: row[2],
awardee: row[3],
agency: row[4],
category: row[5],
designation: row[6],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadbooknew = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= booknew.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        name: row[0],
booktitle: row[1],
papertitle: row[2],
proceeding: row[3],
yop: row[4],
issn: row[5],
publisher: row[6],
affiliated: row[7],
conferencename: row[8],
level: row[9],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadexpenditurenew = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= expenditurenew.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
totalexp: row[1],
budget: row[2],
infraexp: row[3],
booksexp: row[4],
physicalexp: row[5],
academicexp: row[6],
otherexp: row[7],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadqualitynew = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= qualitynew.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
type: row[1],
action: row[2],
instname: row[3],
activity: row[4],
startdate: row[5],
enddate: row[6],
partstatus: row[7],
other: row[8],
meetings: row[9],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadlquality = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= lquality.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
auditaction: row[1],
conference: row[2],
instnameact: row[3],
orientact: row[4],
partstatus: row[5],
other: row[6],
disableaudit: row[7],
scholarname: row[8],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploaduquality = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= uquality.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        type: row[0],
ifadopt: row[1],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadstudschspnew = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= studschspnew.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
scheme: row[1],
noofgovstud: row[2],
amountgov: row[3],
noofinststud: row[4],
amountinst: row[5],
noofngostud: row[6],
amountngo: row[7],
ngoagencyname: row[8],
noofinsdustrystud: row[9],
amountindustry: row[10],
industry: row[11],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadustudschsp = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ustudschsp.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
title: row[1],
sname: row[2],
regno: row[3],
amount: row[4],
type: row[5],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


// mar 29 2023 1

exports.uploadstudmasterall = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= studmasterall.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
programname: row[1],
programcode: row[2],
student: row[3],
regno: row[4],
admissionyear: row[5],
isfinalyear: row[6],
repeat: row[7],
gender: row[8],
category1: row[9],
category2: row[10],
pwd: row[11],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};

// mar 31 2023

exports.uploadamprograms = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= amprograms.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        program: row[0],
programcode: row[1],
nature: row[2],
subject: row[3],
fees: row[4],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadamclassroom = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= amclassroom.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        code: row[0],
carpetarea: row[1],
allotment: row[2],
rooftype: row[3],
furniture: row[4],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadamequipments = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= amequipments.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        equipment: row[0],
category: row[1],
make: row[2],
modelno: row[3],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadamlibrary = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= amlibrary.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        engbooks: row[0],
tamilbooks: row[1],
otherbooks: row[2],
engjournal: row[3],
tamiljournal: row[4],
otherjournal: row[5],
engnews: row[6],
tamilnews: row[7],
othernews: row[8],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadamlibdetails = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= amlibdetails.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        title: row[0],
author: row[1],
publisher: row[2],
type: row[3],
language: row[4],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadamfaculties = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= amfaculties.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        faculty: row[0],
dob: row[1],
doj: row[2],
designation: row[3],
qualification: row[4],
salary: row[5],
phdmonyr: row[6],
isqualified: row[7],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadamadminstaff = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= amadminstaff.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        Staff: row[0],
dob: row[1],
doj: row[2],
designation: row[3],
qualification: row[4],
salary: row[5],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadaminfsuff = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= aminfsuff.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        item: row[0],
ifsufficient: row[1],
observations: row[2],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadamimprovements = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= amimprovements.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        observations: row[0],
suggestion: row[1],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadamrecommendation = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= amrecommendation.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        program: row[0],
programcode: row[1],
ifok: row[2],
recommendations: row[3],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadamchemicals = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= amchemicals.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        subject: row[0],
type: row[1],
chemical: row[2],
lab: row[3],
total: row[4],
purchasedate: row[5],
ifexcess: row[6],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadamprogfaculties = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= amprogfaculties.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        program: row[0],
programcode: row[1],
faculty: row[2],
dob: row[3],
doj: row[4],
designation: row[5],
qualification: row[6],
salary: row[7],
phdmonyr: row[8],
isqualified: row[9],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


// apr 6 2023

exports.uploadstudmentor = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= studmentor.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
student: row[1],
regno: row[2],
programname: row[3],
programcode: row[4],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadlphdfac = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= lphdfac.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        faculty: row[0],
yearofaward: row[1],
university: row[2],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


// Apr 8 2023

exports.uploadalumniusers = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= alumniusers.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        alumni: row[0],
address: row[1],
city: row[2],
country: row[3],
email: row[4],
phone: row[5],
program: row[6],
regno: row[7],
batch: row[8],
username: row[9],
password: row[10],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadalumniwork = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= alumniwork.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        org: row[0],
doj: row[1],
dol: row[2],
designation: row[3],
description: row[4],
salary: row[5],
orgaddress: row[6],
orgcontact: row[7],
programname: row[8],
batch: row[9],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadalumnihighered = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= alumnihighered.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        institute: row[0],
doj: row[1],
hprogram: row[2],
hregno: row[3],
dol: row[4],
instaddress: row[5],
instcountry: row[6],
programname: row[7],
batch: row[8],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadalumnicontribute = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= alumnicontribute.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        amount: row[0],
purpose: row[1],
refid: row[2],
bank: row[3],
tdate: row[4],
description: row[5],
programname: row[6],
batch: row[7],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadalumnijobs = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= alumnijobs.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        org: row[0],
title: row[1],
role: row[2],
description: row[3],
location: row[4],
description: row[5],
startdate: row[6],
enddate: row[7],
contact: row[8],
programname: row[9],
batch: row[10],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadalumnievents = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= alumnievents.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        event: row[0],
startdate: row[1],
enddate: row[2],
description: row[3],
location: row[4],
registration: row[5],
mode: row[6],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


// apr 14 2023

exports.uploadpfiles = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= pfiles.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        metric: row[0],
topic: row[1],
description: row[2],
source: row[3],
datereceived: row[4],
accreditation: row[5],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadpdeliverables = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= pdeliverables.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        accreditation: row[0],
year: row[1],
topic: row[2],
description: row[3],
metric: row[4],
dateuploaded: row[5],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};

// apr 19 2023

exports.uploadsssstud = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= sssstud.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        student: row[0],
gender: row[1],
category: row[2],
domicile: row[3],
nationality: row[4],
email: row[5],
level: row[6],
discipline: row[7],
department: row[8],
course: row[9],
regno: row[10],
mobile: row[11],
joinyear: row[12],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};

// Apr 28 2023

exports.uploadadmusers = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= admusers.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        student: row[0],
address: row[1],
city: row[2],
country: row[3],
email: row[4],
phone: row[5],
refer: row[6],
referuser: row[7],
username: row[8],
password: row[9],
photo: row[10],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadadmedu = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= admedu.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        level: row[0],
institution: row[1],
degree: row[2],
marks: row[3],
grade: row[4],
year: row[5],
university: row[6],
location: row[7],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadadmwork = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= admwork.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        org: row[0],
doj: row[1],
dol: row[2],
designation: row[3],
description: row[4],
salary: row[5],
orgaddress: row[6],
orgcontact: row[7],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadadmprograms = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= admprograms.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        program: row[0],
programcode: row[1],
year: row[2],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadadmintern = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= admintern.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        org: row[0],
doj: row[1],
dol: row[2],
designation: row[3],
description: row[4],
salary: row[5],
orgaddress: row[6],
orgcontact: row[7],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadadmextra = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= admextra.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        activity: row[0],
year: row[1],
activitydate: row[2],
description: row[3],
org: row[4],
type: row[5],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadadmlanguages = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= admlanguages.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        language: row[0],
readskills: row[1],
writeskills: row[2],
speakskills: row[3],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadadmfacilities = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= admfacilities.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        hostel: row[0],
scholarship: row[1],
visa: row[2],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadadmmarks = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= admmarks.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        degree: row[0],
subject: row[1],
type: row[2],
marks: row[3],
grade: row[4],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


// May 11 2023

exports.uploadassignment = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= assignment.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        coursecode: row[0],
course: row[1],
classdate: row[2],
topic: row[3],
link: row[4],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadcoursefiles = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= coursefiles.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        coursecode: row[0],
filename: row[1],
link: row[2],
status: row[3],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};

// Jun 2 2023

exports.uploadaffassign = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= affassign.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        institutionid: row[0],
institution: row[1],
insname: row[2],
insuser: row[3],
role: row[4],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


// Jun 9 2023

exports.uploadamcpdetails3 = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= amcpdetails3.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
collegeid: row[1],
college: row[2],
item: row[3],
compstatus: row[4],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadamcpobservations = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= amcpobservations.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        collegeid: row[0],
college: row[1],
year: row[2],
program: row[3],
fiveyear: row[4],
qualification: row[5],
classrooms: row[6],
laboratory: row[7],
labequipments: row[8],
labbooks: row[9],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadammember1 = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ammember1.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
collegeid: row[1],
college: row[2],
item: row[3],
compliance: row[4],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadammbr2comp = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ammbr2comp.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
collegeid: row[1],
college: row[2],
item: row[3],
compliance: row[4],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadammbr2det = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= ammbr2det.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
collegeid: row[1],
college: row[2],
item: row[3],
compliance: row[4],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};

// jun 10 2023

exports.uploadmkustud = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= mkustud.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        department: row[0],
deptcode: row[1],
program: row[2],
programcode: row[3],
student: row[4],
studenttamil: row[5],
regno: row[6],
dob: row[7],
sex: row[8],
pwd: row[9],
community: row[10],
comcert: row[11],
aadhar: row[12],
aspdistrict: row[13],
rp: row[14],
nri: row[15],
mobile: row[16],
email: row[17],
scholarship: row[18],
fellowship: row[19],
internship: row[20],
selfcourse: row[21],
guardian: row[22],
guardoccu: row[23],
mother: row[24],
address: row[25],
guardmob: row[26],
guardemail: row[27],
anyother: row[28],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadmkumarks = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= mkumarks.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        department: row[0],
deptcode: row[1],
student: row[2],
regno: row[3],
exam: row[4],
pubdate: row[5],
coursecode: row[6],
course: row[7],
credit: row[8],
maxia: row[9],
maxes: row[10],
maxtot: row[11],
marksia: row[12],
markses: row[13],
markstot: row[14],
gp: row[15],
lg: row[16],
nstatus: row[17],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


// Jun 21 2023

exports.uploadanmstudnew = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= anmstudnew.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        collegecode: row[0],
college: row[1],
coldistrict: row[2],
coltype: row[3],
admissionyear: row[4],
photo: row[5],
email: row[6],
regno: row[7],
rollno: row[8],
student: row[9],
dateofbirth: row[10],
gender: row[11],
religion: row[12],
category: row[13],
caste: row[14],
state: row[15],
nationality: row[16],
mobile: row[17],
aadhar: row[18],
blood: row[19],
department: row[20],
programcode: row[21],
program: row[22],
duration: row[23],
stream: row[24],
medium: row[25],
shift: row[26],
section: row[27],
admissiondate: row[28],
joiningdate: row[29],
counselling: row[30],
studstatus: row[31],
admmode: row[32],
lateral: row[33],
father: row[34],
fincome: row[35],
foccu: row[36],
mother: row[37],
mincome: row[38],
moccu: row[39],
guardian: row[40],
pmobile: row[41],
orphan: row[42],
annualinc: row[43],
cardtype: row[44],
cardno: row[45],
diffable: row[46],
diffabtype: row[47],
diffpercent: row[48],
udidno: row[49],
firstgrad: row[50],
spcat: row[51],
emisno: row[52],
hscboard: row[53],
hscregno: row[54],
language: row[55],
hscmarks: row[56],
hscscholarship: row[57],
lastschol: row[58],
school: row[59],
govtschool: row[60],
tamil: row[61],
address: row[62],
village: row[63],
studdistrict: row[64],
pin: row[65],
prevprog: row[66],
lastyear: row[67],
prevregn: row[68],
prevyear: row[69],
prevpercent: row[70],
previnscode: row[71],
previnscode: row[72],
qualmode: row[73],
hostel: row[74],
hjoindate: row[75],
hleavedate: row[76],
hosteltype: row[77],
bank: row[78],
account: row[79],
accname: row[80],
acctype: row[81],
ifsc: row[82],
branch: row[83],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};

// Jun 22 2023
exports.uploadamastudnew = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= amastudnew.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        collegecode: row[0],
college: row[1],
coldistrict: row[2],
coltype: row[3],
admissionyear: row[4],
photo: row[5],
email: row[6],
regno: row[7],
rollno: row[8],
student: row[9],
dateofbirth: row[10],
gender: row[11],
religion: row[12],
category: row[13],
caste: row[14],
state: row[15],
nationality: row[16],
mobile: row[17],
aadhar: row[18],
blood: row[19],
department: row[20],
programcode: row[21],
program: row[22],
duration: row[23],
stream: row[24],
medium: row[25],
shift: row[26],
section: row[27],
admissiondate: row[28],
joiningdate: row[29],
counselling: row[30],
studstatus: row[31],
admmode: row[32],
lateral: row[33],
father: row[34],
fincome: row[35],
foccu: row[36],
mother: row[37],
mincome: row[38],
moccu: row[39],
guardian: row[40],
pmobile: row[41],
orphan: row[42],
annualinc: row[43],
cardtype: row[44],
cardno: row[45],
diffable: row[46],
diffabtype: row[47],
diffpercent: row[48],
udidno: row[49],
firstgrad: row[50],
spcat: row[51],
emisno: row[52],
hscboard: row[53],
hscregno: row[54],
language: row[55],
hscmarks: row[56],
hscscholarship: row[57],
lastschol: row[58],
school: row[59],
govtschool: row[60],
tamil: row[61],
address: row[62],
village: row[63],
studdistrict: row[64],
pin: row[65],
prevprog: row[66],
lastyear: row[67],
prevregn: row[68],
prevyear: row[69],
prevpercent: row[70],
previnscode: row[71],
previnsname: row[72],
qualmode: row[73],
hostel: row[74],
hjoindate: row[75],
hleavedate: row[76],
hosteltype: row[77],
bank: row[78],
account: row[79],
accname: row[80],
acctype: row[81],
ifsc: row[82],
branch: row[83],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};

// June 22 2023

exports.uploadaffcolprog = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= affcolprog.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        collegecode: row[0],
college: row[1],
collegeid: row[2],
department: row[3],
program: row[4],
programcode: row[5],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadaffproglist = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= affproglist.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        program: row[0],
programcode: row[1],
stream: row[2],
department: row[3],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadInstitutions = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= Institutions.create({
                        colid: row[9],
                        user: user1,
                        name: name,
                        institutionname: row[0],
institutioncode: row[1],
address: row[2],
state: row[3],
district: row[4],
type: row[5],
logo: row[6],
status: row[7],
admincolid: row[8],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};

// Jun 29 2023

exports.uploadrmsucoldeta = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= rmsucoldeta.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        col_name: row[0],
address: row[1],
pincode: row[2],
estab_year: row[3],
instu_type: row[4],
instu_type_code: row[5],
isInsti_auto: row[6],
isInsti_approved: row[7],
ref: row[8],
minority: row[9],
tele_no: row[10],
mob_no: row[11],
fax_no: row[12],
email: row[13],
web_add: row[14],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadrmsunirf = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= rmsunirf.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        academicyear: row[0],
type: row[1],
grade: row[2],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadrsmuaddeta = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= rsmuaddeta.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        acayear: row[0],
currfstyrStudent: row[1],
currscndyrstu: row[2],
currthrdyrstu: row[3],
program: row[4],
programcode: row[5],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadrsmucoldetaex = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= rsmucoldetaex.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        inclusec: row[0],
letno: row[1],
entdate: row[2],
inclusec12: row[3],
letno2: row[4],
entdate2: row[5],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadrsmuprincdeta = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= rsmuprincdeta.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        prinname: row[0],
bday: row[1],
age: row[2],
fatherName: row[3],
address: row[4],
district: row[5],
officeno: row[6],
faxno: row[7],
mobno: row[8],
email: row[9],
ugprogram: row[10],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadrsmugovcouncil = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= rsmugovcouncil.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        position: row[0],
title: row[1],
name: row[2],
email: row[3],
mobile: row[4],
address: row[5],
address2: row[6],
district: row[7],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadrsmuragcomt = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= rsmuragcomt.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        position: row[0],
title: row[1],
name: row[2],
designation: row[3],
email: row[4],
mobile: row[5],
telephone: row[6],
address: row[7],
address2: row[8],
district: row[9],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadrsmuragsquad = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= rsmuragsquad.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        position: row[0],
title: row[1],
name: row[2],
designation: row[3],
email: row[4],
mobile: row[5],
telephone: row[6],
address: row[7],
address2: row[8],
district: row[9],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadrsmubankacnts = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= rsmubankacnts.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        name: row[0],
accountype: row[1],
bankname: row[2],
branch: row[3],
accountno: row[4],
isfc: row[5],
lastbalance: row[6],
lastacademic: row[7],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadrsmudeposit = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= rsmudeposit.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        deposits: row[0],
holderName: row[1],
intiName: row[2],
brancg: row[3],
refno: row[4],
amount: row[5],
maturityDate: row[6],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadrsmuendowment = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= rsmuendowment.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        createdwith: row[0],
depointbank: row[1],
branchname: row[2],
amount: row[3],
program: row[4],
instrument: row[5],
instrumentDate: row[6],
expirydate: row[7],
finanreserve: row[8],
manddexp: row[9],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadrsmubuildeta = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= rsmubuildeta.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        name: row[0],
floor: row[1],
room: row[2],
size: row[3],
assigned: row[4],
classroom: row[5],
classroom2: row[6],
lab: row[7],
lab2: row[8],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadrsmufeduqualif = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= rsmufeduqualif.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        Fact_name: row[0],
mail: row[1],
mob: row[2],
sslc: row[3],
hsc: row[4],
dip: row[5],
degree: row[6],
ug_special: row[7],
college: row[8],
Yop_ug: row[9],
Percentage_UG: row[10],
Pg_special: row[11],
university: row[12],
Yop_pg: row[13],
Percentage_PG: row[14],
Phd_Date_Awarded: row[15],
Mphill_Date_Awarded: row[16],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadrsmufacnew = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= rsmufacnew.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        program: row[0],
sex: row[1],
grossPay: row[2],
dep_name: row[3],
fact_name: row[4],
add1: row[5],
add2: row[6],
dist: row[7],
mob_num: row[8],
email: row[9],
community: row[10],
pan_no: row[11],
pass_no: row[12],
aadh_no: row[13],
dob: row[14],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadrsmuontstaff = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= rsmuontstaff.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        dept: row[0],
title: row[1],
fname: row[2],
lname: row[3],
dsgntn: row[4],
degree: row[5],
doj: row[6],
Experience: row[7],
dob: row[8],
age: row[9],
pay_scale: row[10],
basic_pay: row[11],
gross_pay: row[12],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadrmsucourse = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= rmsucourse.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        category: row[0],
dept: row[1],
title: row[2],
fname: row[3],
lname: row[4],
dsgntn: row[5],
degree: row[6],
doj: row[7],
Experience: row[8],
dob: row[9],
age: row[10],
pay_scale: row[11],
basic_pay: row[12],
gross_pay: row[13],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadrsunontstaff = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= rsunontstaff.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        category: row[0],
dept: row[1],
title: row[2],
fname: row[3],
lname: row[4],
dsgntn: row[5],
degree: row[6],
doj: row[7],
Experience: row[8],
dob: row[9],
age: row[10],
pay_scale: row[11],
basic_pay: row[12],
gross_pay: row[13],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


// Jun 30 2023

exports.uploadrsmuaddetacng = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= rsmuaddetacng.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        acayear: row[0],
currfstyrStudent: row[1],
currscndyrstu: row[2],
currthrdyrstu: row[3],
program: row[4],
programcode: row[5],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadrmsutrustdatacng = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= rmsutrustdatacng.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        trusthead: row[0],
trustname: row[1],
address: row[2],
address2: row[3],
regno: row[4],
dateofreg: row[5],
chairmanname: row[6],
fathername: row[7],
email: row[8],
mobno: row[9],
restelno: row[10],
trustemail: row[11],
trustno: row[12],
offtelno: row[13],
faxno: row[14],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadrsmufacnewcng = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= rsmufacnewcng.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        program: row[0],
sex: row[1],
grosspay: row[2],
depname: row[3],
factname: row[4],
add1: row[5],
add2: row[6],
dist: row[7],
mobnum: row[8],
email: row[9],
community: row[10],
panno: row[11],
passno: row[12],
aadhno: row[13],
dob: row[14],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadrsmuendowmentcng = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= rsmuendowmentcng.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        createdwith: row[0],
depointbank: row[1],
branchname: row[2],
amountrs: row[3],
program: row[4],
instrument: row[5],
instrumentDate: row[6],
expirydate: row[7],
finanreserve: row[8],
manddexp: row[9],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadrsmulanddetacng = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= rsmulanddetacng.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        location: row[0],
location2: row[1],
disctict: row[2],
taluk: row[3],
village: row[4],
place: row[5],
pincode: row[6],
documentno: row[7],
datea: row[8],
survery: row[9],
builtarea: row[10],
landmark: row[11],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


// Jul 3 2023

exports.uploaduser = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= user.create({
                        colid: row[13],
                        user: row[14],
                        name: row[15],
                        email: row[0],
phone: row[1],
password: row[2],
role: row[3],
regno: row[4],
programcode: row[5],
admissionyear: row[6],
semester: row[7],
section: row[8],
gender: row[9],
department: row[10],
category: row[11],
status: row[12],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};

// Jul 3 2023

exports.uploadrsmuadmup = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= rsmuadmup.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        program: row[0],
progcode: row[1],
prognature: row[2],
batch: row[3],
acayear: row[4],
currfstyrStudent: row[5],
currscndyrstu: row[6],
currthrdyrstu: row[7],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadrsmucoldetaup = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= rsmucoldetaup.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        col_name: row[0],
address: row[1],
pincode: row[2],
estab_year: row[3],
instu_type: row[4],
instu_type_code: row[5],
isInsti_auto: row[6],
isInsti_approved: row[7],
ref: row[8],
minority: row[9],
tele_no: row[10],
mob_no: row[11],
fax_no: row[12],
email: row[13],
web_add: row[14],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadrsmutrustup = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= rsmutrustup.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        trustname: row[0],
address: row[1],
district: row[2],
regno: row[3],
dateofreg: row[4],
chairmanname: row[5],
fathername: row[6],
chairemail: row[7],
mobno: row[8],
restelno: row[9],
trustemail: row[10],
trustno: row[11],
offtelno: row[12],
faxno: row[13],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadrsmuprinup = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= rsmuprinup.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        prinname: row[0],
bday: row[1],
age: row[2],
fatherName: row[3],
address: row[4],
district: row[5],
officeno: row[6],
faxno: row[7],
mobno: row[8],
email: row[9],
ugprogram: row[10],
pgdegree: row[11],
ugmarks: row[12],
pgmarks: row[13],
phddate: row[14],
joinDate: row[15],
panno: row[16],
bankno: row[17],
adharno: row[18],
ifsccode: row[19],
qualifyapproval: row[20],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadrsmuendowup = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= rsmuendowup.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        createdwith: row[0],
depointbank: row[1],
branchname: row[2],
amountrs: row[3],
program: row[4],
batch: row[5],
instrument: row[6],
instrumentDate: row[7],
expirydate: row[8],
finanreserve: row[9],
manddexp: row[10],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadrsmuadcourup = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= rsmuadcourup.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        department: row[0],
degree: row[1],
batch: row[2],
introduction: row[3],
accredation: row[4],
affiliation: row[5],
sanctioned: row[6],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadrsmufacnewup = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= rsmufacnewup.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        program: row[0],
fname: row[1],
sex: row[2],
dob: row[3],
depname: row[4],
resadd: row[5],
ressaddd: row[6],
dist: row[7],
mobnum: row[8],
email: row[9],
com: row[10],
panno: row[11],
aadhno: row[12],
ifsccode: row[13],
acnum: row[14],
grosspay: row[15],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadrsmufacqualifup = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= rsmufacqualifup.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        fname: row[0],
sslcyop: row[1],
hscyop: row[2],
dipyop: row[3],
ugyop: row[4],
ugspecial: row[5],
pgyop: row[6],
pgspecial: row[7],
awardmphill: row[8],
awardphd: row[9],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadrsmunontechup = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= rsmunontechup.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        ctg: row[0],
dept: row[1],
dob: row[2],
sex: row[3],
doj: row[4],
edqual: row[5],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};

// Jul 11 2023

exports.uploadnlibtable1 = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nlibtable1.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        yrBudget: row[0],
totArea: row[1],
arReadingRoom: row[2],
noOfRacks: row[3],
noOfComp: row[4],
noOfCompWithInternet: row[5],
internetCon: row[6],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnlibtable2 = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nlibtable2.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        program: row[0],
programcode: row[1],
noOfTitles: row[2],
noOfBooks: row[3],
noOfBooksForRef: row[4],
noOfEbooks: row[5],
noOfJournals: row[6],
place: row[7],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadnofficefacility = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= nofficefacility.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        natureOfwork: row[0],
noOfEmp: row[1],
noOfComp: row[2],
noOfPrinters: row[3],
repFacility: row[4],
noOfSafetyLocker: row[5],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};

// Jul 30 2023

exports.uploadmsusancseatn = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= msusancseatn.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        univid: row[0],
program: row[1],
programcode: row[2],
year: row[3],
sanc: row[4],
admitted: row[5],
level: row[6],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


// Aug 1 2023

exports.uploadmsuallfacnew = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= msuallfacnew.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        program: row[0],
programcode: row[1],
faculty: row[2],
sex: row[3],
address1: row[4],
address2: row[5],
district: row[6],
pin: row[7],
mobile: row[8],
email: row[9],
community: row[10],
pan: row[11],
aadhar: row[12],
dateofbirth: row[13],
salary: row[14],
bank: row[15],
account: row[16],
accountno: row[17],
ifsc: row[18],
accounttype: row[19],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};

// Aug 1 2023 1

exports.uploadawsconfig = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= awsconfig.create({
                        
                        user: user1,
                        name: name,
                        username: row[0],
password: row[1],
bucket: row[2],
region: row[3],
type: row[4],
colid: row[5],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


// Aug 6 2023

exports.uploadbook = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= book.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        booktitle: row[0],
papertitle: row[1],
proceeding: row[2],
yop: row[3],
issn: row[4],
publisher: row[5],
conferencename: row[6],
level: row[7],
affiliated: row[8],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


// Aug 10 2023

exports.uploadfeedback = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= feedback.create({
                        colid: parseInt(row[11]),
                        user: user1,
                        name: name,
                        regno: row[0],
coursecode: row[1],
faculty: row[2],
facultyemail: row[3],
semester: row[4],
section: row[5],
feedbackdate: row[6],
type: row[7],
question: row[8],
option: row[9],
score: row[10],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


// Aug 17 2023

exports.uploadcocal = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= cocal.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        coursecode: row[0],
course: row[1],
programcode: row[2],
program: row[3],
examcode: row[4],
examname: row[5],
semester: row[6],
regno: row[7],
student: row[8],
iamarks: row[9],
extmarks: row[10],
totalmarks: row[11],
co1: row[12],
co2: row[13],
co3: row[14],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};

// Aug 26 2023

exports.uploadpayimages = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= payimages.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        title: row[0],
description: row[1],
link: row[2],
type: row[3],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadalumnipay = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= alumnipay.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        amount: row[0],
paydate: row[1],
refno: row[2],
mode: row[3],
source: row[4],
sourcedetails: row[5],
purpose: row[6],
type: row[7],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


// Aug 27 2023

exports.uploadamfacalln = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= amfacalln.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        facid: row[0],
inscode: row[1],
institution: row[2],
faculty: row[3],
designation: row[4],
department: row[5],
qualification: row[6],
mphildate: row[7],
phddate: row[8],
netdate: row[9],
eligdate: row[10],
dateofbirth: row[11],
type: row[12],
tservicedate: row[13],
regservicedate: row[14],
dstaffdate: row[15],
pinsdate: row[16],
ifqualaff: row[17],
ifpg: row[18],
ugteaching: row[19],
pgteaching: row[20],
email: row[21],
mobile: row[22],
retirementdate: row[23],
account: row[24],
bank: row[25],
branch: row[26],
ifsc: row[27],
pan: row[28],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};

// Aug 29 2023


exports.uploadevguests = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= evguests.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        eventid: row[0],
event: row[1],
guest: row[2],
email: row[3],
phone: row[4],
designation: row[5],
institute: row[6],
address: row[7],
country: row[8],
username: row[9],
password: row[10],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};

// Sep 14 2023

exports.uploadgenderaudit = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= genderaudit.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        student: row[0],
regno: row[1],
filldate: row[2],
security: row[3],
common: row[4],
sanitation: row[5],
cctv: row[6],
classroom: row[7],
library: row[8],
timing: row[9],
daycare: row[10],
medical: row[11],
hostel: row[12],
icc: row[13],
seminar: row[14],
course: row[15],
icccom: row[16],
discriminated: row[17],
equal: row[18],
grievance: row[19],
safe: row[20],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};

// Sep 28 2023

exports.uploadsalarypaid = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= salarypaid.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        employee: row[0],
userid: row[1],
item: row[2],
amount: row[3],
datepaid: row[4],
type: row[5],
bank: row[6],
refno: row[7],
account: row[8],
accountno: row[9],
frombank: row[10],
fromaccount: row[11],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploademptravel = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= emptravel.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        employee: row[0],
userid: row[1],
item: row[2],
clientid: row[3],
client: row[4],
fromdate: row[5],
todate: row[6],
mode: row[7],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};

// Dec 14 2023

exports.uploadaauc1 = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= aauc1.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        institution: row[0],
address: row[1],
pincode: row[2],
phone: row[3],
fax: row[4],
website: row[5],
email: row[6],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadaauc2 = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= aauc2.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        affiliation: row[0],
program: row[1],
type: row[2],
year: row[3],
sanction: row[4],
requested: row[5],
commno: row[6],
apptype: row[7],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadaaucother = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= aaucother.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        anybreak: row[0],
permanent: row[1],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};


exports.uploadaaucfees = function(req, res) {
    //console.log('processing file upload');
    
    upload(req,res,function(err) {
        if(err) {
            //console.log("Error uploading file." + err.toString());
            return res.end("Error uploading file." + err.toString());
        }
        const name=req.body.name;
        const colid=req.body.colid;
        //console.log('files ' + req.files);
        const user1=req.body.user;
        const token=req.body.token;
        //console.log('token ' + token);
        let jwtuser='';
        let jwtcolid='';
        try {
            const verified = jwt.verify(
                token,
                process.env.JWT_SECRET,
                (err123, verified) => {
                  if (err123) {
                    return res.status(401).json({
                        status: 'Unauthorized',
                        error: err123
                    });
                  }
                  jwtuser=verified.user;
                  jwtcolid=verified.colid;
                  return verified;
                }
              );
              //console.log(verified);
    
        } catch(err1234) {
            //console.log(err1234);
        }
        //console.log('token verified ' + jwtuser + '-' + jwtcolid);

        try {
            let path1="public/img/users/" + req.file.filename;
            //console.log(path1);
            readXlsxFile(path1).then((rows) => {
                // skip header
                rows.shift();
      
                let tutorials = [];
      
                rows.forEach((row) => {
                    const pat1= aaucfees.create({
                        colid: colid,
                        user: user1,
                        name: name,
                        year: row[0],
draftno: row[1],
draftdate: row[2],
bank: row[3],
purpose: row[4],
amount: row[5],
status1: 'Submitted',
                        comments: 'NA'
                    
                    });

                    
      
              //tutorials.push(tutorial);
                });
            });
            //console.log('uploaded');
            res.status(401).json({
                status: 'Success'
            });
        } catch(err1) {
            res.status(401).json({
                status: 'Error',
                error: err1
            });

        }

    });
};








